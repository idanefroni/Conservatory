<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This is the manual of MafFilter, version 1.3.1.

Copyright (C) 2018 Julien Y. Dutheil -->
<!-- Created by GNU Texinfo 6.1, http://www.gnu.org/software/texinfo/ -->
<head>
<title>MafFilter Manual 1.3.1</title>

<meta name="description" content="MafFilter Manual 1.3.1">
<meta name="keywords" content="MafFilter Manual 1.3.1">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="#Top" rel="start" title="Top">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<link href="dir.html#Top" rel="up" title="(dir)">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/Core/Steely">


</head>

<body lang="en">
<h1 class="settitle" align="center">MafFilter Manual 1.3.1</h1>




<a name="SEC_Contents"></a>
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">

<ul class="no-bullet">
  <li><a name="toc-Introduction-1" href="#Introduction">1 Introduction</a>
  <ul class="no-bullet">
    <li><a name="toc-Description-of-the-program" href="#Description">1.1 Description of the program</a></li>
    <li><a name="toc-How-to-run-the-program" href="#Run">1.2 How to run the program</a></li>
    <li><a name="toc-General-options" href="#General">1.3 General options</a></li>
  </ul></li>
  <li><a name="toc-Filters-1" href="#Filters">2 Filters</a>
  <ul class="no-bullet">
    <li><a name="toc-Extracting-data" href="#Extracting">2.1 Extracting data</a>
    <ul class="no-bullet">
      <li><a name="toc-Subset_003a-remove-sequences-from-blocks-by-species-name" href="#Subset">2.1.1 Subset: remove sequences from blocks by species name</a></li>
      <li><a name="toc-SelectOrphans_003a-keep-only-block-with-the-specified-species" href="#SelectOrphans">2.1.2 SelectOrphans: keep only block with the specified species</a></li>
      <li><a name="toc-Merging_003a-merge-synthenic-blocks" href="#Merge">2.1.3 Merging: merge synthenic blocks</a></li>
      <li><a name="toc-Concatenating_003a-merge-consecutive-blocks-up-to-a-certain-size" href="#Concatenate">2.1.4 Concatenating: merge consecutive blocks up to a certain size</a></li>
      <li><a name="toc-OrderFilter_003a-check-and-eventually-discard-unordered-or-overlapping-blocks" href="#OrderFilter">2.1.5 OrderFilter: check and eventually discard unordered or overlapping blocks</a></li>
      <li><a name="toc-Extract-features-from-the-alignment" href="#ExtractFeature">2.1.6 Extract features from the alignment</a></li>
      <li><a name="toc-Extract-blocks-for-a-given-chromosome_002fcontig_002fscaffold" href="#SelectChr">2.1.7 Extract blocks for a given chromosome/contig/scaffold</a></li>
      <li><a name="toc-Split-alignment-blocks-into-smaller-parts" href="#WindowSplit">2.1.8 Split alignment blocks into smaller parts</a></li>
    </ul></li>
    <li><a name="toc-Cleaning-alignment-blocks" href="#Cleaning">2.2 Cleaning alignment blocks</a>
    <ul class="no-bullet">
      <li><a name="toc-Minumum-block-length" href="#MinBlockLength">2.2.1 Minumum block length</a></li>
      <li><a name="toc-Minumum-block-size" href="#MinBlockSize">2.2.2 Minumum block size</a></li>
      <li><a name="toc-Exclude-full-gap-columns" href="#XFullGap">2.2.3 Exclude full gap columns</a></li>
      <li><a name="toc-Remove-empty-sequences" href="#RemoveEmptySequences">2.2.4 Remove empty sequences</a></li>
      <li><a name="toc-Alignment-filtering" href="#AlnFilter">2.2.5 Alignment filtering</a></li>
      <li><a name="toc-Alignment-filtering-2" href="#AlnFilter2">2.2.6 Alignment filtering 2</a></li>
      <li><a name="toc-Entropy-filtering" href="#EntropyFilter">2.2.7 Entropy filtering</a></li>
      <li><a name="toc-Masked-sequences-filtering" href="#MaskFilter">2.2.8 Masked sequences filtering</a></li>
      <li><a name="toc-Quality-filtering" href="#QualFilter">2.2.9 Quality filtering</a></li>
      <li><a name="toc-Remove-sequences-from-features-from-the-alignment" href="#FeatureFilter">2.2.10 Remove sequences from features from the alignment</a></li>
    </ul></li>
    <li><a name="toc-Statistical-analysis" href="#Analyzing">2.3 Statistical analysis</a>
    <ul class="no-bullet">
      <li><a name="toc-Descriptive-statistics" href="#Descriptive">2.3.1 Descriptive statistics</a>
      <ul class="no-bullet">
        <li><a name="toc-Size-of-alignment-blocks" href="#BlockSize">2.3.1.1 Size of alignment blocks</a></li>
        <li><a name="toc-Length-of-alignment-blocks" href="#BlockLength">2.3.1.2 Length of alignment blocks</a></li>
        <li><a name="toc-Length-of-sequence-for-a-species" href="#SequenceLength">2.3.1.3 Length of sequence for a species</a></li>
        <li><a name="toc-Alignment-score" href="#AlnScore">2.3.1.4 Alignment score</a></li>
        <li><a name="toc-Character-frequencies" href="#BlockCounts">2.3.1.5 Character frequencies</a></li>
        <li><a name="toc-Pairwise-divergence" href="#PairwiseDivergence">2.3.1.6 Pairwise divergence</a></li>
        <li><a name="toc-Site-statistics" href="#SiteStatistics">2.3.1.7 Site statistics</a></li>
        <li><a name="toc-Counts-of-parsimony-informative-sites-for-a-species-quartet" href="#FourSpeciesSitePatternCounts">2.3.1.8 Counts of parsimony informative sites for a species quartet</a></li>
        <li><a name="toc-Site-frequency-spectrum" href="#SiteFrequencySpectrum">2.3.1.9 Site frequency spectrum</a></li>
        <li><a name="toc-Polymorphism-statistics" href="#PolymorphismStatistics">2.3.1.10 Polymorphism statistics</a></li>
        <li><a name="toc-Sequence-diversity-statistics" href="#DiversityStatistics">2.3.1.11 Sequence diversity statistics</a></li>
        <li><a name="toc-Number-of-sequence-clusters_002e" href="#CountClusters">2.3.1.12 Number of sequence clusters.</a></li>
        <li><a name="toc-Fit-a-substitution-model-and-estimate-parameters" href="#ModelFit">2.3.1.13 Fit a substitution model and estimate parameters</a></li>
      </ul></li>
      <li><a name="toc-Phylogenetics-1" href="#Phylogenetics">2.3.2 Phylogenetics</a>
      <ul class="no-bullet">
        <li><a name="toc-Distance-matrix-estimation" href="#DistanceEstimation">2.3.2.1 Distance matrix estimation</a></li>
        <li><a name="toc-Hierarchical-clustering-based-on-distances" href="#DistanceBasedPhylogeny">2.3.2.2 Hierarchical clustering based on distances</a></li>
        <li><a name="toc-Root-trees" href="#NewOutgroup">2.3.2.3 Root trees</a></li>
        <li><a name="toc-Remove-a-species-from-a-tree" href="#DropSpecies">2.3.2.4 Remove a species from a tree</a></li>
        <li><a name="toc-Filter-blocks-based-on-their-associated-trees" href="#TreeFilter">2.3.2.5 Filter blocks based on their associated trees</a></li>
      </ul></li>
    </ul></li>
    <li><a name="toc-Exporting-blocks-and-data" href="#Exporting">2.4 Exporting blocks and data</a>
    <ul class="no-bullet">
      <li><a name="toc-Write-alignment-blocks-to-a-MAF-file" href="#Output">2.4.1 Write alignment blocks to a MAF file</a></li>
      <li><a name="toc-Write-alignment-blocks-to-an-external-alignment-file_002e" href="#OutputAlignments">2.4.2 Write alignment blocks to an external alignment file.</a></li>
      <li><a name="toc-Export-given-positions-into-a-table-format_002e" href="#OutputAsTable">2.4.3 Export given positions into a table format.</a></li>
      <li><a name="toc-Call-SNPs-from-alignment-blocks-and-export-to-VCF-file" href="#VcfOutput">2.4.4 Call SNPs from alignment blocks and export to VCF file</a></li>
      <li><a name="toc-Export-segregating-sites-to-MSMC-format" href="#MsmcOutput">2.4.5 Export segregating sites to MSMC format</a></li>
      <li><a name="toc-Export-segregating-sites-to-PLINK-format" href="#PlinkOutput">2.4.6 Export segregating sites to PLINK format</a></li>
      <li><a name="toc-Output-coordinates-of-a-set-of-species-for-each-block_002e" href="#OutputCoordinates">2.4.7 Output coordinates of a set of species for each block.</a></li>
      <li><a name="toc-Write-trees-to-a-file_002e" href="#OutputTrees">2.4.8 Write trees to a file.</a></li>
      <li><a name="toc-Write-distance-matrices-to-a-file_002e" href="#OutputDistanceMatrices">2.4.9 Write distance matrices to a file.</a></li>
    </ul></li>
    <li><a name="toc-Miscelaneous-filters" href="#Miscelaneous">2.5 Miscelaneous filters</a>
    <ul class="no-bullet">
      <li><a name="toc-Convert-coordinates-from-one-genome-to-another" href="#LiftOver">2.5.1 Convert coordinates from one genome to another</a></li>
      <li><a name="toc-Call-an-external-program-on-each-block_002e" href="#SystemCall">2.5.2 Call an external program on each block.</a></li>
    </ul></li>
  </ul></li>
</ul>
</div>


<a name="Top"></a>
<div class="header">
<p>
Next: <a href="#Introduction" accesskey="n" rel="next">Introduction</a>, Previous: <a href="dir.html#Top" accesskey="p" rel="prev">(dir)</a>, Up: <a href="dir.html#Top" accesskey="u" rel="up">(dir)</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="The-MafFilter-Manual"></a>
<h1 class="top">The MafFilter Manual</h1>

<p>This is the manual of MafFilter, version 1.3.1.
</p>
<p>Copyright &copy; 2018 Julien Y. Dutheil
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Introduction" accesskey="1">Introduction</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Filters" accesskey="2">Filters</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><th colspan="3" align="left" valign="top"><pre class="menu-comment"> &mdash; The Detailed Node Listing &mdash;

Introduction

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Description" accesskey="3">Description</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Run" accesskey="4">Run</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#General" accesskey="5">General</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Filters

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Extracting" accesskey="6">Extracting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Cleaning" accesskey="7">Cleaning</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Analyzing" accesskey="8">Analyzing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Exporting" accesskey="9">Exporting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Miscelaneous">Miscelaneous</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Extracting data

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Subset">Subset</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SelectOrphans">SelectOrphans</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Merge">Merge</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Concatenate">Concatenate</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OrderFilter">OrderFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#ExtractFeature">ExtractFeature</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SelectChr">SelectChr</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#WindowSplit">WindowSplit</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Cleaning alignment blocks

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#MinBlockLength">MinBlockLength</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#MinBlockSize">MinBlockSize</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#XFullGap">XFullGap</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#RemoveEmptySequences">RemoveEmptySequences</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#AlnFilter">AlnFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#AlnFilter2">AlnFilter2</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#EntropyFilter">EntropyFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#MaskFilter">MaskFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#QualFilter">QualFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#FeatureFilter">FeatureFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Statistical analysis

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Descriptive">Descriptive</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Phylogenetics">Phylogenetics</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Arguments:

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#BlockSize">BlockSize</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#BlockLength">BlockLength</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SequenceLength">SequenceLength</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#AlnScore">AlnScore</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#BlockCounts">BlockCounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#PairwiseDivergence">PairwiseDivergence</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SiteStatistics">SiteStatistics</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#FourSpeciesSitePatternCounts">FourSpeciesSitePatternCounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SiteFrequencySpectrum">SiteFrequencySpectrum</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#PolymorphismStatistics">PolymorphismStatistics</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#DiversityStatistics">DiversityStatistics</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#CountClusters">CountClusters</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#ModelFit">ModelFit</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Phylogenetics

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#DistanceEstimation">DistanceEstimation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#DistanceBasedPhylogeny">DistanceBasedPhylogeny</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#NewOutgroup">NewOutgroup</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#DropSpecies">DropSpecies</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#TreeFilter">TreeFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Exporting blocks and data

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Output">Output</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OutputAlignments">OutputAlignments</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OutputAsTable">OutputAsTable</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#VcfOutput">VcfOutput</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#MsmcOutput">MsmcOutput</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#PlinkOutput">PlinkOutput</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OutputCoordinates">OutputCoordinates</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OutputTrees">OutputTrees</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OutputDistanceMatrices">OutputDistanceMatrices</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Miscelaneous filters

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#LiftOver">LiftOver</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SystemCall">SystemCall</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr></table>



<hr>
<a name="Introduction"></a>
<div class="header">
<p>
Next: <a href="#Filters" accesskey="n" rel="next">Filters</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Top</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Introduction-1"></a>
<h2 class="chapter">1 Introduction</h2>

<p>MafFilter is a program for post-processing genome alignments in the Multiple Alignment Files (MAF) format.
MAF files consist of a series of &quot;blocks&quot;, displaying the alignment of subsequences of the original genomes.
In a typical MAF file, such blocks represent synteny blocks.
See the UCSC website for a detailed description of the file format.
</p>
<p>How to obtain MAF files is not covered in this manual. MAF files are typically generated by packages such as BlastZ, MultiZ, Last or Galaxy, and you should refer to the manual of these resources for more detailed help.
These packages also contain tools for manipulating MAF files, which you might find useful in combination to the program described here.
</p>
<p>Note that several examples are provided along with the source code of the program, and can serve as good training starts.
This manual intends to provide an exhaustive description of the options used in these examples, as well as to provide general information about the way the program works and its underlying algorithms.
</p>

         
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Description" accesskey="1">Description</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Run" accesskey="2">Run</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#General" accesskey="3">General</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Description"></a>
<div class="header">
<p>
Next: <a href="#Run" accesskey="n" rel="next">Run</a>, Previous: <a href="#Introduction" accesskey="p" rel="prev">Introduction</a>, Up: <a href="#Introduction" accesskey="u" rel="up">Introduction</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Description-of-the-program"></a>
<h3 class="section">1.1 Description of the program</h3>

<p>The main goal of MafFilter is to apply a series of &quot;filters&quot; to the original input file.
A &ldquo;filter&rdquo; can be seen as a small program that takes as input one or several maf blocks, and outputs one or several maf block, after performing some actions on them:
</p>
<pre class="verbatim">                         +--------+
   Alignment block(s)    |        |   Alignment block(s)
------------------------&gt;+ Filter +------------------------&gt;
                         |        |
                         +--------+
</pre>
<p>We can roughly distinguish four types of filters:
</p>
<ul>
<li> Filters that take one block as input, and output one single block, possibly after removing some sequences, or even the full block if it did not match a certain criterion,
</li><li> Filters that take one block as input, and split them into several smaller blocks, for instance of a fixed size,
</li><li> Filters that take several blocks as input and output a larger one, typically after concatenating the input blocks,
</li><li> Filters that do not modify the input block and simply forward it, yet after having performed some computations, for instance calculating various statistics.
</li></ul>

<p>A run of MafFilter typically consists in a workflow of filters, applied in a serial way, the output of one filter being taken as input as the next one.
In the current version of MafFilter, only linear workflows are possible, without branching:
</p>
<pre class="verbatim">    +----------+    +----------+    +----------+
    |          |    |          |    |          |
---&gt;+ Filter 1 +---&gt;+ Filter 2 +---&gt;+ Filter 3 +---&gt; Etc.
    |          |    |          |    |          |
    +----------+    +----------+    +----------+
</pre>
<p>Branching processes can however be achieved by outputing the alignment blocks at the branching point, and run various instances of MafFilter on the resulting files:
</p>
<pre class="verbatim">     Run 1
    +----------+    +----------+    +----------+
    |          |    |          |    |          |
---&gt;+ Filter 1 +---&gt;+ Filter 2 +---&gt;+ Filter 3 +---&gt; Etc.
    |          |    |          |    |          |
    +----------+    +----+-----+    +----------+
                         |
                         |    +------------+
                         |    |            |
     Run 2               +---&gt;+ Filter 2.1 +---&gt; Etc.
                              |            |
                              +------------+
</pre>
<p>Some filters allow to generate additional data associated to each alignment block, such as phylogenetic trees.
Such data cannot be written to file together with the blocks, as the MAF format does not support this.
These data are however stored in memory by MafFilter together with the block, as &ldquo;extra-data&rdquo;.
Extra-data are associated with a special tag which is used for refering to them, including for writting them in appropriate output files.
</p>
<p>The next section describes how to specify the series of filters to be applied, and the next chapter provides an exhaustive list of available filters.
</p>

<hr>
<a name="Run"></a>
<div class="header">
<p>
Next: <a href="#General" accesskey="n" rel="next">General</a>, Previous: <a href="#Description" accesskey="p" rel="prev">Description</a>, Up: <a href="#Introduction" accesskey="u" rel="up">Introduction</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="How-to-run-the-program"></a>
<h3 class="section">1.2 How to run the program</h3>

<p>MafFilter is a program written in C++ with the Bio++ libraries. It is a command line program (that is, without graphical user interface) which uses the Bio++ Options (BppO) syntax. 
This syntax is of type &lsquo;<samp>keys</samp>&rsquo;=&lsquo;<samp>values</samp>&rsquo;, which can be passed directly as arguments of the maffilter program
</p><pre class="verbatim">maffilter option1=value1 option2=value2 ... optionN=valueN
</pre><p>or more conveniently, stored in an &ldquo;options&rdquo; file (specified with param=option_file), or a combination of both:
</p><pre class="verbatim">maffilter param=option_file
maffilter param=option_file option1=value1 option2=value2
</pre><p>See the Bio++ Program Suite (BppSuite) manual for more information.
</p>
<p>MafFilter typically takes as input a MAF file and a series of commands which determine the output file(s) that will be written and where.
Additional input files might be specified, such as gene annotation files (typically in GFF/GTF format).
Here is the structure of a minimal option file:
</p>
<pre class="verbatim">DATA=example.file //A user-defined variable, representing the input maf file, without extension
input.file=$(DATA).maf.gz  //Input maf file, gzipped
input.file.compression=gzip
output.log=$(DATA).maffilter.log //Output log file
maf.filter= //A coma separated list of filters, here empty (the programs only read the input file and exits).
</pre><p>The list of filters can be split on multiple lines for convenience, providing each line is escaped by a &rsquo;\&rsquo; at the end to indicate that the next line is a continuation of the current one:
</p><pre class="verbatim">maf.filter=Filter1,\
           Filter2,\
           Filter3
</pre>
<p>Please refer to the Bio++ Program Suite manual for more details, including the use of variables, priority of option values, etc.
</p>

<hr>
<a name="General"></a>
<div class="header">
<p>
Previous: <a href="#Run" accesskey="p" rel="prev">Run</a>, Up: <a href="#Introduction" accesskey="u" rel="up">Introduction</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="General-options"></a>
<h3 class="section">1.3 General options</h3>

<a name="Synopsis_003a"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">input.file=mydata.maf.gz
input.file.compression=gzip
input.format=Maf
output.log=mydata.maffilter.log
...
</pre></div>

<p>or
</p><div class="example">
<pre class="example">input.file=mydata.fasta
input.file.compression=none
input.format=Fasta(zero_based=yes)
output.log=mydata.maffilter.log
...
</pre></div>
</td></tr></table>

<a name="Detailed-description-of-commands_003a"></a>
<h3 class="heading">Detailed description of commands:</h3>

<dl compact="compact">
<dt><code>input.file={path}</code></dt>
<dd><p>The MAF file to parse
</p>
</dd>
<dt><code>input.file.compression=[none|zip|gzip|bzip2]</code></dt>
<dd><p>The compression format of the input file.
</p>
</dd>
<dt><code>input.format={Maf|Fasta}</code></dt>
<dd><p>MafFilter takes by default a MAF file. It is, however, possible to use a fasta file as input,
which will lead MafFilter to run in &quot;single sequence&quot; mode.
In this mode, each sequence of the original file is considered as a distinct block.
This mode might be useful to extract annotations and estimate simple statistics.
Fasta files can be compressed in the same way as MAF files.
The sequence names are expected to be of the form Species:Chromosome:start:strand:length, with possible empty fields.
Coordinates are expected to be 0-based (that is, the first nucleotide is position 0). However, passing the <code>zero_based=no</code> argument to the format name will assume that the first nucleotide is position 1.
</p>
</dd>
<dt><code>input.dots={error|as_gaps|as_unresolved}</code></dt>
<dd><p>If set to <code>as_gaps</code>, dotted characters in sequences will be converted to gaps and treated as such in any further step of the analysis, including output to files. If set to <code>as_unresolved</code>, dots will be converted to &rsquo;N&rsquo;.
</p>
</dd>
<dt><code>input.check_sequence_size={boolean}</code></dt>
<dd><p>Tell if sequence sizes are consistent (default: true). An error will be returned in case of inconsistency.
Desabling size check can be useful in combination with input.dots=as_gaps. In case of inconsistency, a warning will be displayed unless verbose is set to false.
</p>
</dd>
<dt><code>output.log={path}</code></dt>
<dd><p>The file where to write log messages.
</p>
</dd>
<dt><code>maf.filter={Filter1, Filter2, ...}</code></dt>
<dd><p>The main command, specifying the list of filter commands to apply, in the given order (that is, the input of filter 2 will be the output of filter 1).
Filters take a series of arguments, specified within parentheses: <code>Filter(arg1=opt1, arg2=opt2, etc)</code>.
The next section present all available filters and their corresponding arguments.
</p></dd>
</dl>


<hr>
<a name="Filters"></a>
<div class="header">
<p>
Previous: <a href="#Introduction" accesskey="p" rel="prev">Introduction</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Filters-1"></a>
<h2 class="chapter">2 Filters</h2>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Extracting" accesskey="1">Extracting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Cleaning" accesskey="2">Cleaning</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Analyzing" accesskey="3">Analyzing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Exporting" accesskey="4">Exporting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Miscelaneous" accesskey="5">Miscelaneous</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Extracting"></a>
<div class="header">
<p>
Next: <a href="#Cleaning" accesskey="n" rel="next">Cleaning</a>, Previous: <a href="#Filters" accesskey="p" rel="prev">Filters</a>, Up: <a href="#Filters" accesskey="u" rel="up">Filters</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Extracting-data"></a>
<h3 class="section">2.1 Extracting data</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Subset" accesskey="1">Subset</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SelectOrphans" accesskey="2">SelectOrphans</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Merge" accesskey="3">Merge</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Concatenate" accesskey="4">Concatenate</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OrderFilter" accesskey="5">OrderFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#ExtractFeature" accesskey="6">ExtractFeature</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SelectChr" accesskey="7">SelectChr</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#WindowSplit" accesskey="8">WindowSplit</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>


<hr>
<a name="Subset"></a>
<div class="header">
<p>
Next: <a href="#SelectOrphans" accesskey="n" rel="next">SelectOrphans</a>, Previous: <a href="#Extracting" accesskey="p" rel="prev">Extracting</a>, Up: <a href="#Extracting" accesskey="u" rel="up">Extracting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Subset_003a-remove-sequences-from-blocks-by-species-name"></a>
<h4 class="subsection">2.1.1 Subset: remove sequences from blocks by species name</h4>

<p>The <code>Subset</code> filter allows to filter sequences for each block by keeping only a selection of species.
</p>
<a name="Synopsis_003a-1"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    Subset(                                 \
        species=(species1, species2, etc),  \
        strict=yes,                         \
        keep=no,                            \
        remove_duplicates=yes),             \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>species=(species1, species2, etc)</code></dt>
<dd><p>A coma separated, within parentheses, list of species. Only sequences corresponding to the selected species will be kept.
Block without sequences from the selection will be discarded.
</p>
</dd>
<dt><code>strict=yes/no</code></dt>
<dd><p>If set to yes, only blocks containing at least one sequence from each species in the selection will be kept.
</p>        
</dd>
<dt><code>keep=yes/no</code></dt>
<dd><p>If strict is set to yes, tells if additional sequences should be kept in the block, or remove so that the output blocks only contain species from the selection.
</p>        
</dd>
<dt><code>remove_duplicates=yes/no</code></dt>
<dd><p>If set to yes, only keep blocks for which only one sequence for each species is present. Blocks with paralogous sequences in at least one species will therefore be discarded. 
</p>
</dd>
</dl>


<hr>
<a name="SelectOrphans"></a>
<div class="header">
<p>
Next: <a href="#Merge" accesskey="n" rel="next">Merge</a>, Previous: <a href="#Subset" accesskey="p" rel="prev">Subset</a>, Up: <a href="#Extracting" accesskey="u" rel="up">Extracting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="SelectOrphans_003a-keep-only-block-with-the-specified-species"></a>
<h4 class="subsection">2.1.2 SelectOrphans: keep only block with the specified species</h4>

<p>The <code>SelectOrphans</code> filter allows to discard all block with species out of the specified range.
This is typically used to extract blocks with no homolog (&quot;orphan&quot;).
</p>
<a name="Synopsis_003a-2"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    SelectOrphans(                          \
        species=(species1, species2, etc),  \
        strict=yes,                         \
        remove_duplicates=yes),             \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-1"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>species=(species1, species2, etc)</code></dt>
<dd><p>A coma separated, within parentheses, list of species.
All block containing at least one species outside this list will be discarded.
</p>
</dd>
<dt><code>strict=yes/no</code></dt>
<dd><p>If set to yes, only block containing at least one sequence from each species in the selection will be kept.
</p>        
</dd>
<dt><code>remove_duplicates=yes/no</code></dt>
<dd><p>If set to yes, only keep blocks for which only one sequence for each species is present.
Blocks with paralogous sequences in at least one species will therefore be discarded. 
</p>
</dd>
</dl>


<hr>
<a name="Merge"></a>
<div class="header">
<p>
Next: <a href="#Concatenate" accesskey="n" rel="next">Concatenate</a>, Previous: <a href="#SelectOrphans" accesskey="p" rel="prev">SelectOrphans</a>, Up: <a href="#Extracting" accesskey="u" rel="up">Extracting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Merging_003a-merge-synthenic-blocks"></a>
<h4 class="subsection">2.1.3 Merging: merge synthenic blocks</h4>

<p>The <code>Merge</code> filter fuses consecutive blocks based on their coordinates.
Blocks will be fused only if the sequences from a specified set of species can be considered as syntenic.
Two sequences are considered as syntenic if:
</p><ul>
<li> they are from the same species
</li><li> they are from the same chromosome
</li><li> they are from the same strand
</li><li> they are distant by less than a defined threshold (the start of sequence 2 - the end of sequence 1 &lt; threshold in bp).
</li></ul>

<a name="Synopsis_003a-3"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    Merge(                                  \
        species=(species1, species2, etc),  \
        dist_max=0,                         \
        ignore_chr=(Random,Unknown),        \
        rename_chimeric_chromosomes=yes),   \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-2"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>species=(species1, species2, etc)</code></dt>
<dd><p>A coma separated, within parentheses, list of species.
These species only will be used for the synteny check.
Other species will be concatenated in any situation, and their coordinates removed.
</p>
</dd>
<dt><code>dist_max={int}</code></dt>
<dd><p>Maximum distance (in nt) to consider sequences as syntenic.
If dist_max is greater than 0, sequences will be filled with &rsquo;N&rsquo; to preserve coordinates when they are fused.
</p>
</dd>
<dt><code>ignore_chr={none | (list)}</code></dt>
<dd><p>An optional parenthetic list of chromosomes to ignore (typically &quot;Unknown&quot;, or &quot;Random&quot;, etc.).
Sequences annotated with such chromosomes will not be checked for synteny and the corresponding block will not be fused.
</p>
</dd>
<dt><code>rename_chimeric_chromosomes={boolean}</code></dt>
<dd><p>When distinct chromosomes are merged (in non specified species), their names are concatenated. If this option is set to &quot;yes&quot;,
then merged chromosomes will be renamed as &quot;chimtigXXX&quot; where XXX is a number auto-incremented for each species.
</p>
</dd>
</dl>


<hr>
<a name="Concatenate"></a>
<div class="header">
<p>
Next: <a href="#OrderFilter" accesskey="n" rel="next">OrderFilter</a>, Previous: <a href="#Merge" accesskey="p" rel="prev">Merge</a>, Up: <a href="#Extracting" accesskey="u" rel="up">Extracting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Concatenating_003a-merge-consecutive-blocks-up-to-a-certain-size"></a>
<h4 class="subsection">2.1.4 Concatenating: merge consecutive blocks up to a certain size</h4>

<p>The <code>Concatenate</code> filter fuses consecutive blocks until the concatenated block reaches a minimal size.
</p>
<a name="Synopsis_003a-4"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    Concatenate(minimum_size=10000, ref_species=Hsapiens), \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-3"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>minimum_size={int}</code></dt>
<dd><p>The minimum size for the blocks to be reached.
</p>
</dd>
<dt><code>ref_species={string}</code></dt>
<dd><p>If given, only blocks with identical chromosome tags in the reference species will be merged.
</p>
</dd>
</dl>


<hr>
<a name="OrderFilter"></a>
<div class="header">
<p>
Next: <a href="#ExtractFeature" accesskey="n" rel="next">ExtractFeature</a>, Previous: <a href="#Concatenate" accesskey="p" rel="prev">Concatenate</a>, Up: <a href="#Extracting" accesskey="u" rel="up">Extracting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="OrderFilter_003a-check-and-eventually-discard-unordered-or-overlapping-blocks"></a>
<h4 class="subsection">2.1.5 OrderFilter: check and eventually discard unordered or overlapping blocks</h4>

<p>The <code>OrderFilter</code> filter check if blocks are sorted according to previous block.
</p>
<a name="Synopsis_003a-5"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    OrderFilter(                            \
        reference=ref_genome,               \
        do_unsorted=discard,                \
        do_overlapping=discard),            \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-4"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>reference={string}</code></dt>
<dd><p>The sequence for which coordinates should be checked. Block where the reference sequence is absent will be considered as ordered.
</p>
<p>Important note: the alignment is supposed to be projected according to the reference sequence. Using the filter on another species might lead to unexpected behavior, in particular as the the reference species is supposed to be mapped on the + strand only.
</p>
</dd>
<dt><code>do_unsorted={none|discard|error}</code></dt>
<dd><p>Action to perform in case an unsorted block is found (that is, when the right coordinate of the current block is before the left coordinate of the previous one).
If &rsquo;discard&rsquo;, the block will be removed. If &rsquo;error&rsquo;, the maffilter with stop with an error.
</p>
</dd>
<dt><code>do_overlapping={none|discard|error}</code></dt>
<dd><p>Action to perform in case an ovelrapping block is found (that is, when the left coordinate of the current block is before the right coordinate of the previous one, and the right coordinate of the current block is not before the left coordinate of the previous one).
If &rsquo;discard&rsquo;, the block will be removed. If &rsquo;error&rsquo;, the maffilter with stop with an error.
</p></dd>
</dl>


<hr>
<a name="ExtractFeature"></a>
<div class="header">
<p>
Next: <a href="#SelectChr" accesskey="n" rel="next">SelectChr</a>, Previous: <a href="#OrderFilter" accesskey="p" rel="prev">OrderFilter</a>, Up: <a href="#Extracting" accesskey="u" rel="up">Extracting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Extract-features-from-the-alignment"></a>
<h4 class="subsection">2.1.6 Extract features from the alignment</h4>

<p>The <code>ExtractFeature</code> extracts parts of the alignment corresponding to certain features.
The features to extract are typically provided via a GFF file. 
</p>
<a name="Synopsis_003a-6"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...]
    ExtractFeature(                         \
        ref_species=species1,               \
        feature.file=species1.gff3.gz,      \
        feature.file.compression=gzip,      \
        feature.format=GFF,                 \
        feature.type=mRNA,                  \
        compression=gzip,                   \
        complete=yes,                       \
        ignore_strand=no),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-5"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>ref_species={string}</code></dt>
<dd><p>The name of the species for which the coordinates of the features are provided.
</p>
</dd>
<dt><code>feature.file={path}</code></dt>
<dd><p>The file where the features are described.
</p>
</dd>
<dt><code>feature.file.compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for the feature file.
</p>
</dd>
<dt><code>feature.format={GFF|GTF|BedGraph}</code></dt>
<dd><p>Format for the feature file, currently GFF (v3.0), GTF or BedGraph.
</p>
</dd>
<dt><code>feature.type={all|(list)}</code></dt>
<dd><p>Specifies which type of feature should be extracted from the feature file, if several are available.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file (if file != none).
</p>
</dd>
<dt><code>complete={yes|no}</code></dt>
<dd><p>Tell if only complete features should be extracted or if partial extraction is allowed.
</p>
</dd>
<dt><code>ignore_strand={yes|no}</code></dt>
<dd><p>If yes, features will be extracted &ldquo;as is&rdquo;. Otherwise, the invert-complement sequence will be returned if it is located on the negative strand.
</p>
</dd>
</dl>


<hr>
<a name="SelectChr"></a>
<div class="header">
<p>
Next: <a href="#WindowSplit" accesskey="n" rel="next">WindowSplit</a>, Previous: <a href="#ExtractFeature" accesskey="p" rel="prev">ExtractFeature</a>, Up: <a href="#Extracting" accesskey="u" rel="up">Extracting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Extract-blocks-for-a-given-chromosome_002fcontig_002fscaffold"></a>
<h4 class="subsection">2.1.7 Extract blocks for a given chromosome/contig/scaffold</h4>

<p>The <code>SelectChr</code> filter keeps only block from a given chromosome (or contig or scaffold...) for a given reference species.
</p>
<a name="Synopsis_003a-7"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    SelectChr(                              \
        ref_species=species1,               \
        chromosome=chr01),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-6"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>ref_species={string}</code></dt>
<dd><p>The species name for which chromosomes should be extracted.
</p>
</dd>
<dt><code>chromosome={string}</code></dt>
<dd><p>The name of the chromosome/contig/scaffold to be filtered.
</p>
</dd>
</dl>


<hr>
<a name="WindowSplit"></a>
<div class="header">
<p>
Previous: <a href="#SelectChr" accesskey="p" rel="prev">SelectChr</a>, Up: <a href="#Extracting" accesskey="u" rel="up">Extracting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Split-alignment-blocks-into-smaller-parts"></a>
<h4 class="subsection">2.1.8 Split alignment blocks into smaller parts</h4>

<p>The <code>WindowSplit</code> filter subdivides blocks into smaller ones of a regular size, typically for window-based analyses.
It is possible to generate overlapping windows.
</p>
<a name="Synopsis_003a-8"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    WindowSplit(                            \
        preferred_size=1000,                \
        align=center,                       \
        keep_small_blocks=no),              \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-7"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>preferred_size={int&gt;0}</code></dt>
<dd><p>The preferred size for the output windows.
</p>
</dd>
<dt><code>align={ragged_left|ragged_right|center|adjust}</code></dt>
<dd><p>Specifies how to align windows on the block:
</p>
</dd>
<dt><code>keep_small_blocks = {boolean}</code></dt>
<dd><p>Tell if blocks with an original size smaller that the window size should be kept (and untouched).
This option only works if the align option is set to adjust. The combination of &quot;align=adjust&quot; and &quot;keep_small_blocks=yes&quot; allows to ensure that blocks do not exceed a given size, without losing any data.
</p>
<dl compact="compact">
<dt><code>ragged_left</code></dt>
<dd><pre class="verbatim">Block   |----------------------------|
Windows |----|----|----|----|----|XXXX
</pre>
</dd>
<dt><code>ragged_right</code></dt>
<dd><pre class="verbatim">Block   |----------------------------|
Windows XXXX|----|----|----|----|----|
</pre>
</dd>
<dt><code>center</code></dt>
<dd><pre class="verbatim">Block   |----------------------------|
Windows XX|----|----|----|----|----|XX
</pre>
</dd>
<dt><code>adjust</code></dt>
<dd><pre class="verbatim">Block   |----------------------------|
Windows |-----|-----|-----|-----|----|
</pre></dd>
</dl>
<p>In the first three case, some parts of the original block (shown with X) will be discarded.
In the last case, the windows will have at least the specified size, but might be larger.
</p></dd>
</dl>


<hr>
<a name="Cleaning"></a>
<div class="header">
<p>
Next: <a href="#Analyzing" accesskey="n" rel="next">Analyzing</a>, Previous: <a href="#Extracting" accesskey="p" rel="prev">Extracting</a>, Up: <a href="#Filters" accesskey="u" rel="up">Filters</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Cleaning-alignment-blocks"></a>
<h3 class="section">2.2 Cleaning alignment blocks</h3>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#MinBlockLength" accesskey="1">MinBlockLength</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#MinBlockSize" accesskey="2">MinBlockSize</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#XFullGap" accesskey="3">XFullGap</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#RemoveEmptySequences" accesskey="4">RemoveEmptySequences</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#AlnFilter" accesskey="5">AlnFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#AlnFilter2" accesskey="6">AlnFilter2</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#EntropyFilter" accesskey="7">EntropyFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#MaskFilter" accesskey="8">MaskFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#QualFilter" accesskey="9">QualFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#FeatureFilter">FeatureFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="MinBlockLength"></a>
<div class="header">
<p>
Next: <a href="#MinBlockSize" accesskey="n" rel="next">MinBlockSize</a>, Previous: <a href="#Cleaning" accesskey="p" rel="prev">Cleaning</a>, Up: <a href="#Cleaning" accesskey="u" rel="up">Cleaning</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Minumum-block-length"></a>
<h4 class="subsection">2.2.1 Minumum block length</h4>

<p>The <code>MinBlockLength</code> filter discards blocks with less sites than a given threshold.
</p>
<a name="Synopsis_003a-9"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    MinBlockLength(min_length=1000),        \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-8"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>min_length={int&gt;0}</code></dt>
<dd><p>The minimum length.
</p>
</dd>
</dl>


<hr>
<a name="MinBlockSize"></a>
<div class="header">
<p>
Next: <a href="#XFullGap" accesskey="n" rel="next">XFullGap</a>, Previous: <a href="#MinBlockLength" accesskey="p" rel="prev">MinBlockLength</a>, Up: <a href="#Cleaning" accesskey="u" rel="up">Cleaning</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Minumum-block-size"></a>
<h4 class="subsection">2.2.2 Minumum block size</h4>

<p>The <code>MinBlockSize</code> filter discards blocks with less sequences than a given threshold.
</p>
<a name="Synopsis_003a-10"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    MinBlockSize(min_size=3),               \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-9"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>min_size={int&gt;0}</code></dt>
<dd><p>The minimum size.
</p>
</dd>
</dl>


<hr>
<a name="XFullGap"></a>
<div class="header">
<p>
Next: <a href="#RemoveEmptySequences" accesskey="n" rel="next">RemoveEmptySequences</a>, Previous: <a href="#MinBlockSize" accesskey="p" rel="prev">MinBlockSize</a>, Up: <a href="#Cleaning" accesskey="u" rel="up">Cleaning</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Exclude-full-gap-columns"></a>
<h4 class="subsection">2.2.3 Exclude full gap columns</h4>

<p>Remove gap-only columns from blocks. This does not modify coordinates and might be necessary after a <code>Subset</code> filter.
</p>
<a name="Synopsis_003a-11"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    XFullGap(
        species=(species1,species2,etc)),   \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-10"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>species=(species1, species2, etc)</code></dt>
<dd><p>A coma separated, within parentheses, list of species. Any column containing a gap in the specified species will be removed. If other species are present in the block, the corresponding character will be removed, whether it is a gap or not. The coordinates of these species will then be discarded.
</p>
</dd>
</dl>


<hr>
<a name="RemoveEmptySequences"></a>
<div class="header">
<p>
Next: <a href="#AlnFilter" accesskey="n" rel="next">AlnFilter</a>, Previous: <a href="#XFullGap" accesskey="p" rel="prev">XFullGap</a>, Up: <a href="#Cleaning" accesskey="u" rel="up">Cleaning</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Remove-empty-sequences"></a>
<h4 class="subsection">2.2.4 Remove empty sequences</h4>

<p>The <code>RemoveEmptySequences</code> filter remove sequences containing only gap (or unresolved characters) in each block.
</p>
<a name="Synopsis_003a-12"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    RemoveEmptySequences(unresolved_as_gaps=yes),        \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-11"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>unresolved_as_gaps={boolean}</code></dt>
<dd><p>Tell if unresolved characters count as &quot;empty&quot; as well.
</p>
</dd>
</dl>


<hr>
<a name="AlnFilter"></a>
<div class="header">
<p>
Next: <a href="#AlnFilter2" accesskey="n" rel="next">AlnFilter2</a>, Previous: <a href="#RemoveEmptySequences" accesskey="p" rel="prev">RemoveEmptySequences</a>, Up: <a href="#Cleaning" accesskey="u" rel="up">Cleaning</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Alignment-filtering"></a>
<h4 class="subsection">2.2.5 Alignment filtering</h4>

<p>Split alignment blocks by removing regions with ambiguous alignments.
The local uncertainty in the alignment is determined through a sliding window based approach.
For each window, the number of gap characters and the total entropy are computed. Any window
for which both the entropy and number of gaps exceed the given thresholds will be removed from
the alignment, and the corresponding block split accordingly.
</p>
<a name="Synopsis_003a-13"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    AlnFilter(                              \
        species=(species1,species2,etc),    \
        window.size=10,                     \
        window.step=1,                      \
        max.gap=9,                          \
        max.ent=0.2,                        \
        missing_as_gap=yes,                 \
        relative=no,                        \
        file=data.trash_aln.maf.gz,         \
        compression=gzip),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-12"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>species=(species1, species2, etc)</code></dt>
<dd><p>A coma separated, within parentheses, list of species. All calculations will be performed on the sub-alignment corresponding to these species only.
</p>
</dd>
<dt><code>window.size={int&gt;0}</code></dt>
<dd><p>The width, in bp, of the sliding window.
</p>
</dd>
<dt><code>window.step={int&gt;0}</code></dt>
<dd><p>The step by which the window is moved, in bp.
</p>
</dd>
<dt><code>relative={boolean}</code></dt>
<dd><p>Tell if maximum amount of gap is relative (that is, as a proportion of the total amount of character in each window).
</p>
</dd>
<dt><code>max.gap={int&gt;0|1&gt;double&gt;0}</code></dt>
<dd><p>The maximum number of gaps allowed in each window (if relative is set to no), or the maximum proportion of gaps (if relative is set to yes)
</p>
</dd>
<dt><code>max.ent={float}</code></dt>
<dd><p>The maximum entropy allowed in each window.
</p>
</dd>
<dt><code>missing_as_gap={yes/no}</code></dt>
<dd><p>Tell if missing sequences should be considered as gaps.
</p>
</dd>
<dt><code>file={none|{path}}</code></dt>
<dd><p>An optional file were removed alignment parts will be stored, in the MAF format.
This can be helpful for visual inspection and fine tuning of the filter parameters.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file (if file != none).
</p>
</dd>
</dl>


<hr>
<a name="AlnFilter2"></a>
<div class="header">
<p>
Next: <a href="#EntropyFilter" accesskey="n" rel="next">EntropyFilter</a>, Previous: <a href="#AlnFilter" accesskey="p" rel="prev">AlnFilter</a>, Up: <a href="#Cleaning" accesskey="u" rel="up">Cleaning</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Alignment-filtering-2"></a>
<h4 class="subsection">2.2.6 Alignment filtering 2</h4>

<p>This is another algorithm for cleaning alignment blocks (see AlnFilter), using sliding windows.
The number of gaps in each alignment column in the window is counted, and the column is masked if it contains more than a given threshold of gaps. consecutive patterns in the window are only counted ones. In the follwing 10nt window:
</p><pre class="verbatim">AATCGGGCGT
AA---GCGGA
AA---CGGGT
CA---CGGGA
</pre><p>positions 3, 4 and 5 will be masked if the maximum number of gaps allowed is 2 or less. The three columns will however count as only one indel event.
The window is then discarded if it contains more than a given number of indel events.
</p>
<a name="Synopsis_003a-14"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    AlnFilter2(                             \
        species=(species1,species2,etc),    \
        window.size=10,                     \
        window.step=1,                      \
        max.gap=1,                          \
        max.pos=1,                          \
        relative=no,                        \
        missing_as_gap=yes,                 \
        file=data.trash_aln.maf.gz,         \
        compression=gzip),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-13"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>species=(species1, species2, etc)</code></dt>
<dd><p>A coma separated, within parentheses, list of species. All calculations will be performed on the sub-alignment corresponding to these species only.
</p>
</dd>
<dt><code>window.size={int&gt;0}</code></dt>
<dd><p>The width, in bp, of the sliding window.
</p>
</dd>
<dt><code>window.step={int&gt;0}</code></dt>
<dd><p>The step by which the window is moved, in bp.
</p>
</dd>
<dt><code>relative={boolean}</code></dt>
<dd><p>Tell if maximum amount of gap is relative (that is, as a proportion of the total amount of character in each site).
</p>
</dd>
<dt><code>max.gap={int&gt;0|1&gt;double&gt;0}</code></dt>
<dd><p>The maximum number of gaps allowed in each site (if relative is set to no), or the maximum proportion of gaps (if relative is set to yes)
</p>
</dd>
<dt><code>max.pos={int&gt;0}</code></dt>
<dd><p>The maximum number of positions with gaps (&ldquo;indel events&rdquo;).
</p>
</dd>
<dt><code>missing_as_gap={yes/no}</code></dt>
<dd><p>Tell if missing sequences should be considered as gaps.
</p>
</dd>
<dt><code>file={none|{path}}</code></dt>
<dd><p>An optional file were removed alignment parts will be stored, in the MAF format.
This can be helpful for visual inspection and fine tuning of the filter parameters.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file (if file != none).
</p>
</dd>
</dl>


<hr>
<a name="EntropyFilter"></a>
<div class="header">
<p>
Next: <a href="#MaskFilter" accesskey="n" rel="next">MaskFilter</a>, Previous: <a href="#AlnFilter2" accesskey="p" rel="prev">AlnFilter2</a>, Up: <a href="#Cleaning" accesskey="u" rel="up">Cleaning</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Entropy-filtering"></a>
<h4 class="subsection">2.2.7 Entropy filtering</h4>

<p>This filter removes highly variable regions and split the blocks accordingly.
It uses a sliding windows, and compute the entropy for each site in the window.
The window is then discarded if it containes more than &rsquo;p&rsquo; sites with an entropy higher that a user-specified threshold. The alignment block is then split into separate block accordingly.
</p>
<a name="Synopsis_003a-15"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    EntropyFilter(                          \
        species=(species1,species2,etc),    \
        window.size=10,                     \
        window.step=1,                      \
        max.ent=0.2,                        \
        max.pos=3,                          \
        missing_as_gap=yes,                 \
        ignore_gaps=yes,                    \
        file=data.trash_ent.maf.gz,         \
        compression=gzip),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-14"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>species=(species1, species2, etc)</code></dt>
<dd><p>A coma separated, within parentheses, list of species. All calculations will be performed on the sub-alignment corresponding to these species only.
</p>
</dd>
<dt><code>window.size={int&gt;0}</code></dt>
<dd><p>The width, in bp, of the sliding window.
</p>
</dd>
<dt><code>window.step={int&gt;0}</code></dt>
<dd><p>The step by which the window is moved, in bp.
</p>
</dd>
<dt><code>max.ent={float}</code></dt>
<dd><p>The maximum entropy allowed at each site.
</p>
</dd>
<dt><code>max.pos={int&gt;0}</code></dt>
<dd><p>The maximum number of positions with an entropy higher than the given threshold.
</p>
</dd>
<dt><code>missing_as_gap={yes/no}</code></dt>
<dd><p>Tell if unresolved characters should be counted as gaps.
</p>
</dd>
<dt><code>ignore_gaps={yes/no}</code></dt>
<dd><p>Tell if gaps should not be counted in entropy calculation. If no, then gaps are counted as a &ldquo;fifth&rdquo; state.
</p>
</dd>
<dt><code>file={none|{path}}</code></dt>
<dd><p>An optional file were removed alignment parts will be stored, in the MAF format.
This can be helpful for visual inspection and fine tuning of the filter parameters.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file (if file != none).
</p>
</dd>
</dl>


<hr>
<a name="MaskFilter"></a>
<div class="header">
<p>
Next: <a href="#QualFilter" accesskey="n" rel="next">QualFilter</a>, Previous: <a href="#EntropyFilter" accesskey="p" rel="prev">EntropyFilter</a>, Up: <a href="#Cleaning" accesskey="u" rel="up">Cleaning</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Masked-sequences-filtering"></a>
<h4 class="subsection">2.2.8 Masked sequences filtering</h4>

<p>The <code>MaskFilter</code> split alignment blocks by removing regions with too many masked positions (typically showing repeat-content), using sliding windows.
A masked position is identified by a lower case letter in the original sequence.
Windows with more than a given amount of lower case characters will be discarded, and the corresponding block split.
</p>
<a name="Synopsis_003a-16"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    MaskFilter(                             \
        species=(species1,species2,etc),    \
        window.size=10,                     \
        window.step=1,                      \
        max.masked=2,                       \
        file=data.trash_msk.maf.gz,         \
        compression=gzip),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-15"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>species=(species1, species2, etc)</code></dt>
<dd><p>A coma separated, within parentheses, list of species. All calculations will be performed on the sub-alignment corresponding to these species only.
</p>
</dd>
<dt><code>window.size={int&gt;0}</code></dt>
<dd><p>The width, in bp, of the sliding window.
</p>
</dd>
<dt><code>window.step={int&gt;0}</code></dt>
<dd><p>The step by which the window is moved, in bp.
</p>
</dd>
<dt><code>max.masked={int&gt;0}</code></dt>
<dd><p>The maximum number of lower-case characters allowed in each window.
</p>
</dd>
<dt><code>file={none|{path}}</code></dt>
<dd><p>An optional file were removed alignment parts will be stored, in the MAF format.
This can be helpful for visual inspection and fine tuning of the filter parameters.
</p>
</dd>
<dt><code>compresion={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file (if file != none).
</p>
</dd>
</dl>


<hr>
<a name="QualFilter"></a>
<div class="header">
<p>
Next: <a href="#FeatureFilter" accesskey="n" rel="next">FeatureFilter</a>, Previous: <a href="#MaskFilter" accesskey="p" rel="prev">MaskFilter</a>, Up: <a href="#Cleaning" accesskey="u" rel="up">Cleaning</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Quality-filtering"></a>
<h4 class="subsection">2.2.9 Quality filtering</h4>

<p>The <code>QualFilter</code> split alignment blocks by removing regions with too low quality score.
Windows with an average quality below a given threshold will be discarded, and the corresponding block split.
</p>
<a name="Synopsis_003a-17"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    QualFilter(                             \
        species=(species1,species2,etc),    \
        window.size=10,                     \
        window.step=1,                      \
        min.qual=0.8,                       \
        file=data.trash_qual.maf.gz,        \
        compression=gzip),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-16"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>species=(species1, species2, etc)</code></dt>
<dd><p>A coma separated, within parentheses, list of species. All calculations will be performed on the sub-alignment corresponding to these species only. The corresponding sequences must have a quality score line in the original file.
</p>
</dd>
<dt><code>window.size={int&gt;0}</code></dt>
<dd><p>The width, in bp, of the sliding window.
</p>
</dd>
<dt><code>window.step={int&gt;0}</code></dt>
<dd><p>The step by which the window is moved, in bp.
</p>
</dd>
<dt><code>min.qual={double}</code></dt>
<dd><p>The minimum average quality allowed for each window.
</p>
</dd>
<dt><code>file={none|{path}}</code></dt>
<dd><p>An optional file were removed alignment parts will be stored, in the MAF format.
This can be helpful for visual inspection and fine tuning of the filter parameters.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file (if file != none).
</p>
</dd>
</dl>

<hr>
<a name="FeatureFilter"></a>
<div class="header">
<p>
Previous: <a href="#QualFilter" accesskey="p" rel="prev">QualFilter</a>, Up: <a href="#Cleaning" accesskey="u" rel="up">Cleaning</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Remove-sequences-from-features-from-the-alignment"></a>
<h4 class="subsection">2.2.10 Remove sequences from features from the alignment</h4>

<p>The <code>FeatureFilter</code> remove parts of the alignment corresponding to certain features.
The features to extract are typically provided via a GFF file. See <code>ExtractFeature</code>
in order to keep only the feature parts.
</p>
<a name="Synopsis_003a-18"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    FeatureFilter(                          \
        ref_species=species1,               \
        feature.file=species1.gff3,         \
        feature.file.compression=none,      \
        feature.format=GFF,                 \
        feature.type=(mRNA,tRNA),           \
        file=data.trash_features.maf.gz,    \
        compression=gzip),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-17"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>ref_species={string}</code></dt>
<dd><p>The name of the species for which the coordinates of the features are provided.
</p>
</dd>
<dt><code>feature.file={path}</code></dt>
<dd><p>The file where the features are described.
</p>
</dd>
<dt><code>feature.file.compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for the feature file.
</p>
</dd>
<dt><code>feature.format={GFF|GTF|BedGraph}</code></dt>
<dd><p>Format for the feature file, currently GFF (v3.0), GTF or BedGraph.
</p>
</dd>
<dt><code>feature.type={all|(list)}</code></dt>
<dd><p>Specifies which type of feature should be extracted from the feature file, if several are available.
</p>
</dd>
<dt><code>file={none|{path}}</code></dt>
<dd><p>An optional file were extracted features will be stored, in the MAF format.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file (if file != none).
</p>
</dd>
</dl>




<hr>
<a name="Analyzing"></a>
<div class="header">
<p>
Next: <a href="#Exporting" accesskey="n" rel="next">Exporting</a>, Previous: <a href="#Cleaning" accesskey="p" rel="prev">Cleaning</a>, Up: <a href="#Filters" accesskey="u" rel="up">Filters</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Statistical-analysis"></a>
<h3 class="section">2.3 Statistical analysis</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Descriptive" accesskey="1">Descriptive</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Phylogenetics" accesskey="2">Phylogenetics</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Descriptive"></a>
<div class="header">
<p>
Next: <a href="#Phylogenetics" accesskey="n" rel="next">Phylogenetics</a>, Previous: <a href="#Analyzing" accesskey="p" rel="prev">Analyzing</a>, Up: <a href="#Analyzing" accesskey="u" rel="up">Analyzing</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Descriptive-statistics"></a>
<h4 class="subsection">2.3.1 Descriptive statistics</h4>

<p>The section describes how to compute simple statistics for each alignment block.
For the sake of computer efficiency, several statistics can be computed simultaneously on each alignment block.
The results are written in a text file, with one line per block and one column per statistics.
In addition, the coordinates of the block will be reported according to a specified reference species.
The choice of statistics is specified by the user. Some of them output several results, which will appear each in a column in the output file.
</p>
<p>Descriptive statistics are computed through the <code>SequenceStatistics</code> filter, which takes the following arguments:
</p>
<a name="Synopsis_003a-19"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    SequenceStatistics(                     \
        statistics=(\                       \
            BlockLength,                    \
            AlnScore,                       \
            BlockCounts),                   \
        ref_species=species1,               \
        file=data.statistics.csv,           \
        compression=none),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-18"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>statistics={list of statistics functions}</code></dt>
<dd><p>See below for the list of possible functions and their detailed description.
</p>
</dd>
<dt><code>ref_species={string}</code></dt>
<dd><p>The species to use to report block coordinates in the output file. For block where the reference species is missing, NA will be output.
</p>
</dd>
<dt><code>file={path}</code></dt>
<dd><p>A file path for the output file.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
</dl>

<p>The statistics to compute take the form of functions (just like filters themselves), which can potentially take arguments.
Here is the list of currently available statistical functions:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#BlockSize" accesskey="1">BlockSize</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#BlockLength" accesskey="2">BlockLength</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SequenceLength" accesskey="3">SequenceLength</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#AlnScore" accesskey="4">AlnScore</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#BlockCounts" accesskey="5">BlockCounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#PairwiseDivergence" accesskey="6">PairwiseDivergence</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SiteStatistics" accesskey="7">SiteStatistics</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#FourSpeciesSitePatternCounts" accesskey="8">FourSpeciesSitePatternCounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SiteFrequencySpectrum" accesskey="9">SiteFrequencySpectrum</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#PolymorphismStatistics">PolymorphismStatistics</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#DiversityStatistics">DiversityStatistics</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#CountClusters">CountClusters</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#ModelFit">ModelFit</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="BlockSize"></a>
<div class="header">
<p>
Next: <a href="#BlockLength" accesskey="n" rel="next">BlockLength</a>, Previous: <a href="#Descriptive" accesskey="p" rel="prev">Descriptive</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Size-of-alignment-blocks"></a>
<h4 class="subsubsection">2.3.1.1 Size of alignment blocks</h4>
<p>The <code>BlockSize</code> statistics reports the number of sequences in the block.
</p>
<p>(No argument)
</p>
<hr>
<a name="BlockLength"></a>
<div class="header">
<p>
Next: <a href="#SequenceLength" accesskey="n" rel="next">SequenceLength</a>, Previous: <a href="#BlockSize" accesskey="p" rel="prev">BlockSize</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Length-of-alignment-blocks"></a>
<h4 class="subsubsection">2.3.1.2 Length of alignment blocks</h4>
<p>The <code>BlockLength</code> statistics reports the number of sites in the block.
</p>
<p>(No argument)
</p>
<hr>
<a name="SequenceLength"></a>
<div class="header">
<p>
Next: <a href="#AlnScore" accesskey="n" rel="next">AlnScore</a>, Previous: <a href="#BlockLength" accesskey="p" rel="prev">BlockLength</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Length-of-sequence-for-a-species"></a>
<h4 class="subsubsection">2.3.1.3 Length of sequence for a species</h4>
<p>The <code>SequenceLength</code> statistics computes the length (in bp) of the sequence of one species. It returns 0 if no sequence for this species is found in the current block.
It will send an error however if the block has more than one sequence for this species (be sure to use the <code>Subset</code> filter before, if needed).
</p>
<a name="Synopsis_003a-20"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],                                   
    SequenceStatistics(                     \
        statistics=(\                       \
            [...],                                                    
            SequenceLength(                 \
                species=species1),          \
            [...]),                         \
        ref_species=species1,               \
        file=data.statistics.csv),          \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-19"></a>
<h3 class="heading">Arguments:</h3>
<dl compact="compact">
<dt><code>species={string}</code></dt>
<dd><p>The species for which lengths should be reported.
</p></dd>
</dl>

<hr>
<a name="AlnScore"></a>
<div class="header">
<p>
Next: <a href="#BlockCounts" accesskey="n" rel="next">BlockCounts</a>, Previous: <a href="#SequenceLength" accesskey="p" rel="prev">SequenceLength</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Alignment-score"></a>
<h4 class="subsubsection">2.3.1.4 Alignment score</h4>
<p>The <code>AlnScore</code> statistics reports the alignment score associated to the block, if any.
</p>
<p>(No argument)
</p>
<hr>
<a name="BlockCounts"></a>
<div class="header">
<p>
Next: <a href="#PairwiseDivergence" accesskey="n" rel="next">PairwiseDivergence</a>, Previous: <a href="#AlnScore" accesskey="p" rel="prev">AlnScore</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Character-frequencies"></a>
<h4 class="subsubsection">2.3.1.5 Character frequencies</h4>
<p>The <code>BlockCounts</code> statistics reports the count of each character found in the block.
</p>
<p>Note: this statistics does not work in case of duplicated sequences (multiple hits from the same chromosome / scaffold / contig).
</p>
<a name="Arguments_003a-20"></a>
<h3 class="heading">Arguments:</h3>
<dl compact="compact">
<dt><code>species={list}</code></dt>
<dd><p>A list of species to be considered in the counts calculations. If no species is given, all sequences are used.
</p></dd>
<dt><code>suffix={string}</code></dt>
<dd><p>An (optional) suffix to append to the statistics name. Useful in case the statistics should be computed for several species independently.
</p></dd>
</dl>

<hr>
<a name="PairwiseDivergence"></a>
<div class="header">
<p>
Next: <a href="#SiteStatistics" accesskey="n" rel="next">SiteStatistics</a>, Previous: <a href="#BlockCounts" accesskey="p" rel="prev">BlockCounts</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Pairwise-divergence"></a>
<h4 class="subsubsection">2.3.1.6 Pairwise divergence</h4>
<p>The <code>PairwiseDivergence</code> computes the divergence (percentage of mistmatch) between two species.
If at least one of the species is missing, NaN is returned.
It will send an error however if the block has more than one sequence for this species (be sure to use the <code>Subset</code> filter before, if needed).
</p>
<a name="Synopsis_003a-21"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],                                   
    SequenceStatistics(                     \
        statistics=(\                       \
            [...],                                                    
            PairwiseDivergence(             \
                species1=species1,          \
                species2=species1),         \
            [...]),                         \
        ref_species=species1,               \
        file=data.statistics.csv),          \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-21"></a>
<h3 class="heading">Arguments:</h3>
<dl compact="compact">
<dt><code>species1={string}</code></dt>
<dd><p>The first species for which divergence should be reported.
</p></dd>
<dt><code>species2={string}</code></dt>
<dd><p>The second species for which divergence should be reported.
</p></dd>
</dl>

<hr>
<a name="SiteStatistics"></a>
<div class="header">
<p>
Next: <a href="#FourSpeciesSitePatternCounts" accesskey="n" rel="next">FourSpeciesSitePatternCounts</a>, Previous: <a href="#PairwiseDivergence" accesskey="p" rel="prev">PairwiseDivergence</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Site-statistics"></a>
<h4 class="subsubsection">2.3.1.7 Site statistics</h4>
<p><code>SiteStatistics</code> computes site-wise statistics, including:
</p><ul>
<li> Number of sites without gap,
</li><li> Number of complete sites (no gap, no unresolved character),
</li><li> Number of complete sites with only one state (constant sites),
</li><li> Number of complete sites with only two states (biallelic sites),
</li><li> Number of complete sites with only three states (triallelic sites),
</li><li> Number of complete sites with all four states (quadriallelic sites),
</li><li> Number of parsimony-informative sites.
</li></ul>
<p>The statistics are computed for a given subset of species (typically forming a ingroup).
</p>
<a name="Synopsis_003a-22"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],                                   
    SequenceStatistics(                     \
        statistics=(\                       \
            [...],                                                    
            SiteStatistics(                 \
                species=species1),          \
            [...]),                         \
        ref_species=species1,               \
        file=data.statistics.csv),          \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-22"></a>
<h3 class="heading">Arguments:</h3>
<dl compact="compact">
<dt><code>species={list}</code></dt>
<dd><p>A list of species to be considered in the statistics calculations.
</p></dd>
</dl>

<hr>
<a name="FourSpeciesSitePatternCounts"></a>
<div class="header">
<p>
Next: <a href="#SiteFrequencySpectrum" accesskey="n" rel="next">SiteFrequencySpectrum</a>, Previous: <a href="#SiteStatistics" accesskey="p" rel="prev">SiteStatistics</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Counts-of-parsimony-informative-sites-for-a-species-quartet"></a>
<h4 class="subsubsection">2.3.1.8 Counts of parsimony informative sites for a species quartet</h4>
<p>The <code>FourSpeciesSitePatternCounts</code> computes the frequency of each type of informative sites.
With four species, 3 types are expected: 1100, 0110 and 1010. On entry will be output for each of these types.
The remaining sites will be pulled in a column called &ldquo;Ignored&rdquo;.
</p> 
<a name="Synopsis_003a-23"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],                                   
    SequenceStatistics(                     \
        statistics=(\                       \
            [...],                                                    
            FourSpeciesSitePatternCounts(   \
                species1=sp1,               \
                species2=sp2,               \
                species3=sp3,               \
                species4=sp4                \
            [...]),                         \
        ref_species=sp1,                    \
        file=data.statistics.csv),          \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-23"></a>
<h3 class="heading">Arguments:</h3>
<dl compact="compact">
<dt><code>species1=species</code></dt>
<dd><p>First species to consider (resp. second, third and fourth).
</p>
</dd>
</dl>

<hr>
<a name="SiteFrequencySpectrum"></a>
<div class="header">
<p>
Next: <a href="#PolymorphismStatistics" accesskey="n" rel="next">PolymorphismStatistics</a>, Previous: <a href="#FourSpeciesSitePatternCounts" accesskey="p" rel="prev">FourSpeciesSitePatternCounts</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Site-frequency-spectrum"></a>
<h4 class="subsubsection">2.3.1.9 Site frequency spectrum</h4>
<p>The <code>SiteFrequencySpectrum</code> computes the site frequency spectrum for each block.
Only positions in the alignment with only two states are considered.
The proportions of bi-allelic sites are then computed by bins.
Lets consider the following example with 7 sequences:
</p><pre class="verbatim">ACGT
ACTT
AGTT
AGTT
TCTT
TCTT
TCTT
</pre><p>It contains one site with 4/7 (eq 3/7), one site with 2/7 (eq 5/7), one site with 1/7 (eq 6/7) and one site 0/7 (eq 7/7).
With seven sequences, there are actually 4 possibles frequencies: 1/7, 2/7, 3/7 and 4/7 (plus the 0/7 frequency, corresponding to a site with no-mutation).
It is possible to compute all these frequencies individually by settingthe <code>bounds</code> parameter to
</p><pre class="verbatim">SiteFrequencySpectrum(bounds=(-0.5,0.5,1.5,2.5,3.5,4.5), ...)
</pre><p>which will output the number of site with 0, 1, 2, 3 or 4 minor states. Sites with more than 2 states are always counted separately, as well as sites containing unresolved characters.
If one want to count only constant sites for instance, one can simply type
</p><pre class="verbatim">SiteFrequencySpectrum(bounds=(-0.5,0.5), ...)
</pre><p>The remaining sites will be pulled in a column called &ldquo;Ignored&rdquo;.
</p> 
<a name="Synopsis_003a-24"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],                                   
    SequenceStatistics(                     \
        statistics=(\                       \
            [...],                                                    
            SiteFrequencySpectrum(          \
                bounds=(-0.5, 0.5, 1.5),    \
                ingroup=(pop1, pop2, pop3), \
                outgroup=species2,          \
            [...]),                         \
        ref_species=pop1,                   \
        file=data.statistics.csv),          \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-24"></a>
<h3 class="heading">Arguments:</h3>
<dl compact="compact">
<dt><code>bounds={list of double}</code></dt>
<dd><p>The bounds delimiting the bins of the spectrum to be computed.
</p>
</dd>
<dt><code>ingroup={list}</code></dt>
<dd><p>A list of species forming the ingroup and on which the statistics should be calculated.
</p>
</dd>
<dt><code>outgroup=species</code></dt>
<dd><p>A species name saying which sequence should be used to determine the ancestral state. If non-empty, the unfolded frequency spectrum will be computed.
If empty, the folded frequency spectrum will be returned (1/5 and 4/5 frequences will be pulled, so that the maximum frequency will be 1/2).
</p>
</dd>
</dl>

<hr>
<a name="PolymorphismStatistics"></a>
<div class="header">
<p>
Next: <a href="#DiversityStatistics" accesskey="n" rel="next">DiversityStatistics</a>, Previous: <a href="#SiteFrequencySpectrum" accesskey="p" rel="prev">SiteFrequencySpectrum</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Polymorphism-statistics"></a>
<h4 class="subsubsection">2.3.1.10 Polymorphism statistics</h4>
<p>Compute various statistics describing sequence polymorphism. Two aligned sets of &ldquo;species&rdquo; are compared, and the number of polymorphic / fixed sites are computed: 
</p><dl compact="compact">
<dt><code>F</code></dt>
<dd><p>Number of sites fixed in the two sets
</p></dd>
<dt><code>FF</code></dt>
<dd><p>Number of sites fixed in the two sets, yet with a distinct state
</p></dd>
<dt><code>P</code></dt>
<dd><p>Number of sites that are polymorphic in the two sets
</p></dd>
<dt><code>FP</code></dt>
<dd><p>Number of sites that are fixed in set 1 but polymorhic in set 2
</p></dd>
<dt><code>PF</code></dt>
<dd><p>Number of sites that are fixed in set 2 but polymorphic in set 1
</p></dd>
</dl>

<p>Positions containing a gap or an unresolved character in one set are considered ambiguous.
Such positions are counted separately in the following quantities:
</p><dl compact="compact">
<dt><code>X</code></dt>
<dd><p>Number of sites unresolved in the two sets
</p></dd>
<dt><code>FX</code></dt>
<dd><p>Number of sites fixed in set 1 and unresolved in set 2
</p></dd>
<dt><code>XF</code></dt>
<dd><p>Number of sites fixed in set 2 and unresolved in set 1
</p></dd>
<dt><code>PX</code></dt>
<dd><p>Number of sites polymorphic in set 1 and unresolved in set 2
</p></dd>
<dt><code>XP</code></dt>
<dd><p>Number of sites polymorphic in set 2 and unresolved in set 1
</p></dd>
</dl>

<a name="Synopsis_003a-25"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],                                   
    SequenceStatistics(                     \
        statistics=(\                       \
            [...],                                                    
            SiteFrequencySpectrum(          \
                bounds=(-0.5, 0.5, 1.5),    \
                ingroup=(pop1, pop2, pop3), \
                outgroup=species2,          \
            [...]),                         \
        ref_species=pop1,                   \
        file=data.statistics.csv),          \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-25"></a>
<h3 class="heading">Arguments:</h3>
<dl compact="compact">
<dt><code>species1={list}</code></dt>
<dd><p>A list of species for set 1.
</p></dd>
<dt><code>species2={list}</code></dt>
<dd><p>A list of species for set 2.
</p></dd>
</dl>

<p>Note that the &ldquo;species&rdquo; terminology relates to multispecies alignments, as originally implemented in the MultiZ aligner. These statistics will however be most relevant when the aligned sequences are actually from individuals from the same population / species. The term &ldquo;species&rdquo; is here therefore to be taken in terchnical terms (a sequence id in the alignment), and not biological. 
</p>
<hr>
<a name="DiversityStatistics"></a>
<div class="header">
<p>
Next: <a href="#CountClusters" accesskey="n" rel="next">CountClusters</a>, Previous: <a href="#PolymorphismStatistics" accesskey="p" rel="prev">PolymorphismStatistics</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Sequence-diversity-statistics"></a>
<h4 class="subsubsection">2.3.1.11 Sequence diversity statistics</h4>
<p><code>DiversityStatistics</code> computes sequence diversity statistics, including:
</p><ul>
<li> Number of segregating sites,
</li><li> Watterson&rsquo;s theta.
</li><li> Tajima&rsquo;s pi (average pairwise dissimilarity).
</li><li> Tajima&rsquo;s D.
</li></ul>

<a name="Synopsis_003a-26"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                   \
    [...],                                   
    SequenceStatistics(                       \
        statistics=(\                         \
            [...],                                                    
            DiversityStatistics(              \
                ingroup=(samp1,samp2,samp3)), \
            [...]),                           \
        ref_species=samp1,                    \
        file=data.statistics.csv),            \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-26"></a>
<h3 class="heading">Arguments:</h3>
<dl compact="compact">
<dt><code>ingroup={list}</code></dt>
<dd><p>A list of sequences to be considered in the statistics calculations.
</p></dd>
</dl>


<hr>
<a name="CountClusters"></a>
<div class="header">
<p>
Next: <a href="#ModelFit" accesskey="n" rel="next">ModelFit</a>, Previous: <a href="#DiversityStatistics" accesskey="p" rel="prev">DiversityStatistics</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Number-of-sequence-clusters_002e"></a>
<h4 class="subsubsection">2.3.1.12 Number of sequence clusters.</h4>
<p><code>CountClusters</code> counts the number of sequence clusters. This requires that a clustering tree was previously computed (see below).
</p>
<a name="Synopsis_003a-27"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],                                   
    SequenceStatistics(                     \
        statistics=(\                       \
            [...],                                                    
            CountClusters(                  \
                tree=bionj,                 \
                threshold=0.001),           \
            [...]),                         \
        ref_species=species1,               \
        file=data.statistics.csv),          \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-27"></a>
<h3 class="heading">Arguments:</h3>
<dl compact="compact">
<dt><code>tree={string}</code></dt>
<dd><p>The tag name used to store the previously computed tree.
</p>
</dd>
<dt><code>threshold={double}</code></dt>
<dd><p>The threshold to use in order to compute clusters. A threshold of 0.001 for instance means that sequences within each cluster will be divergent by maximum 0.001, while sequences in distinct clusters will be divergent by at least 0.001.
</p> 
</dd>
</dl>


<hr>
<a name="ModelFit"></a>
<div class="header">
<p>
Previous: <a href="#CountClusters" accesskey="p" rel="prev">CountClusters</a>, Up: <a href="#Descriptive" accesskey="u" rel="up">Descriptive</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Fit-a-substitution-model-and-estimate-parameters"></a>
<h4 class="subsubsection">2.3.1.13 Fit a substitution model and estimate parameters</h4>

<p><code>ModelFit</code> fits a substitution model to the input block, given a phylogenetic tree.
All nucleotide homogeneous models can be used, with or without rate across sites variation.
</p>
<a name="Synopsis_003a-28"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],                                   
    SequenceStatistics(                     \
        statistics=(\                       \
            [...],                                                    
            ModelFit(                       \
                model=HKY85(                \
                     kappa=1,               \
                     theta=0.5,             \
                     theta1=0.5,            \
                     theta2=0.5),           \
                rate_distribution=Gamma(    \
                     n=4,                   \
                     alpha=0.5),            \
                tree=BioNJ,                 \
                parameters_output=(         \
                     HKY85.theta,           \
                     HKY85.theta1,          \
                     HKY85.theta2,          \
                     HKY85.kappa),          \
                fixed_parameters=(),        \
                reestimate_brlen=yes,       \
                max_freq_gaps=0.3,          \
                gaps_as_unresolved=yes)),   \
            [...]),                         \
        ref_species=species1,               \
        file=data.statistics.csv),          \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-28"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>model={string}</code></dt>
<dd><p>Substitution model to use. See the Bio++ Program Suite manual for an extensive description of available models.
All nucleotide models can be used.
</p>
</dd>
<dt><code>rate_distribution={string}</code></dt>
<dd><p>The distribution for rates across sites. See the Bio++ Program Suite manual for all available distributions.
</p>
</dd>
<dt><code>root_freq={None|Full|GC}</code></dt>
<dd><p>Allow root frequencies to be different (non-stationary model). Root frequencies can be fully parametrized, or parametrized with GC content.
</p>
</dd>
<dt><code>tree={string|none}</code></dt>
<dd><p>The property name under which trees are stored for each block. If set to &ldquo;none&rdquo;, then an input file should be given.
</p>
</dd>
<dt><code>tree.file={path}[tree=none]</code></dt>
<dd><p>Path for tree file, in case no property is set.
</p>
</dd>
<dt><code>tree.format={Newick|Nhx}[tree=none]</code></dt>
<dd><p>Format for tree file, in case no property is set.
</p>
</dd>
<dt><code>parameters_output={list}</code></dt>
<dd><p>A list of parameter names to output as statistics.
</p>
</dd>
<dt><code>fixed_parameters={list}</code></dt>
<dd><p>A list of parameters which should not be optimized, but fixed to their initila values.
</p>
</dd>
<dt><code>reestimate_brlen={boolean}</code></dt>
<dd><p>Tell if the branches of the tree should be reestimated for each block together with other model parameters.
</p>
</dd>
<dt><code>max_freq_gaps={float}</code></dt>
<dd><p>The maximum proportion of gaps for a site to be included in the analysis.
</p>
</dd>
<dt><code>gaps_as_unresolved={yes/no}</code></dt>
<dd><p>Tell if remaining gaps should be converted to &rsquo;N&rsquo; before likelihood computation. This should be &rsquo;yes&rsquo; unless you specify a substitution model which explicitely allows for gaps.
</p>
</dd>
<dt><code>global_clock={yes/no}</code></dt>
<dd><p>Assume a global clock for branch lengths.
</p>
</dd>
<dt><code>reparametrize={yes/no}</code></dt>
<dd><p>Transform parameters to remove constraints (can improve optimization, but is usually slower).
</p>
</dd>
</dl>


<hr>
<a name="Phylogenetics"></a>
<div class="header">
<p>
Previous: <a href="#Descriptive" accesskey="p" rel="prev">Descriptive</a>, Up: <a href="#Analyzing" accesskey="u" rel="up">Analyzing</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Phylogenetics-1"></a>
<h4 class="subsection">2.3.2 Phylogenetics</h4>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#DistanceEstimation" accesskey="1">DistanceEstimation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#DistanceBasedPhylogeny" accesskey="2">DistanceBasedPhylogeny</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#NewOutgroup" accesskey="3">NewOutgroup</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#DropSpecies" accesskey="4">DropSpecies</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#TreeFilter" accesskey="5">TreeFilter</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="DistanceEstimation"></a>
<div class="header">
<p>
Next: <a href="#DistanceBasedPhylogeny" accesskey="n" rel="next">DistanceBasedPhylogeny</a>, Previous: <a href="#Phylogenetics" accesskey="p" rel="prev">Phylogenetics</a>, Up: <a href="#Phylogenetics" accesskey="u" rel="up">Phylogenetics</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Distance-matrix-estimation"></a>
<h4 class="subsubsection">2.3.2.1 Distance matrix estimation</h4>

<p>Estimates a pairwise distance matrix.
</p>
<a name="Synopsis_003a-29"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    DistanceEstimation(                     \
        method=count,                       \
        gap_option=no_double_gap,           \
        unresolved_as_gap=no,               \
        extended_names=yes),                \
    [...]
</pre></div>
<p>or
</p><div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    DistanceEstimation(                     \
        method=ml,                          \
        model=K80(kappa=2),                 \
        rate=Gamma(n=4, alpha=0.5),         \
        parameter_estimation=initial,       \
        max_freq_gaps=0.33,                 \
        gaps_as_unresolved=yes,             \
        profiler=none,                      \
        message_handler=none,               \
        extended_names=yes),                \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-29"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>method={count|ml}</code></dt>
<dd><p>Method used to estimate distance, either observed count or maximum likelihood estimate.
</p></dd>
</dl>

<p>Further arguments for the observed counts:
</p><dl compact="compact">
<dt><code>gap_option={string}</code></dt>
<dd><p>Specifies how to deal with gaps:
</p><dl compact="compact">
<dt><code>all</code></dt>
<dd><p>All positions are used. Gaps are considered as a fifth character.
</p></dd>
<dt><code>no_full_gap</code></dt>
<dd><p>Positions only made of gaps in the alignment block are ignored. Alternatively, a gap in the two sequences is ocnsidered as a match (gap are a &ldquo;fifth&rdquo; charcater).
</p></dd>
<dt><code>no_double_gap</code></dt>
<dd><p>For each pairwise comparison, positions where a gap is found in both sequences are ignored.
</p></dd>
<dt><code>no_gap</code></dt>
<dd><p>For each pairwise comparison, any gap-containing position is ignored. This is the recommended option for building phylogenies.
</p></dd>
</dl>

</dd>
<dt><code>unresolved_as_gap={yes|no}</code></dt>
<dd><p>Tell is unresolved characters should be treated as gaps (usually in order to be ignored).
</p>
</dd>
<dt><code>extended_names={boolean}</code></dt>
<dd><p>Tell if sequence coordinates should be included in the sequence names stored in the output matrix.
</p></dd>
</dl>

<p>Further arguments for the ML method:
</p><dl compact="compact">
<dt><code>model={substitution model description}</code></dt>
<dd><p>See the Bio++ Program Suite manual for a description of substitution models available. Only nucleotide models can be used.
</p><div class="example">
<pre class="example">model=JC
model=K80(kappa=2)
model=T92(kappa=2, theta=0.5)
model=GTR
</pre></div>

</dd>
<dt><code>rate={rate distribution description}</code></dt>
<dd><p>See the Bio++ Program Suite manual for a description of available options.
</p><div class="example">
<pre class="example">rate=Constant
rate=Gamma(n=4, alpha=0.5)
</pre></div>

</dd>
<dt><code>profiler={none|std|{path}}</code></dt>
<dd><p>Where to print optimization steps (nowhere, standard output or to a given file).
</p>
</dd>
<dt><code>message_handler={none|std|{path}}</code></dt>
<dd><p>Where to log optimization (nowhere, standard output or to a given file).
</p>
</dd>
<dt><code>parameter_estimation={initial|pairwise}</code></dt>
<dd><p>How to estimate substitution process parameters (for instance kappa and alpha).
Available options are either to leave them to their initial values, or to estimate them for each pair of sequences.
</p>
</dd>
<dt><code>max_freq_gaps={float}</code></dt>
<dd><p>The maximum proportion of gaps for a site to be included in the analysis.
</p>
</dd>
<dt><code>gaps_as_unresolved={yes/no}</code></dt>
<dd><p>Tell if remaining gaps should be converted to &rsquo;N&rsquo; before likelihood computation. This should be &rsquo;yes&rsquo; unless you specify a substitution model which explicitely allows for gaps.
</p></dd>
</dl>


<a name="Extra_002ddata_003a"></a>
<h3 class="heading">Extra-data:</h3>

<dl compact="compact">
<dt><code>CountDistance or MLDistance</code></dt>
<dd><p>The estimated pairwise distance matrix.
</p></dd>
</dl>


<hr>
<a name="DistanceBasedPhylogeny"></a>
<div class="header">
<p>
Next: <a href="#NewOutgroup" accesskey="n" rel="next">NewOutgroup</a>, Previous: <a href="#DistanceEstimation" accesskey="p" rel="prev">DistanceEstimation</a>, Up: <a href="#Phylogenetics" accesskey="u" rel="up">Phylogenetics</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Hierarchical-clustering-based-on-distances"></a>
<h4 class="subsubsection">2.3.2.2 Hierarchical clustering based on distances</h4>

<p>Performs hierarchical clustering from a previously computed distance matrix.
</p>
<a name="Synopsis_003a-30"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    DistanceBasedPhylogeny(                 \
        method=bionj,                       \
        dist_mat=MLDistance),               \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-30"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>method={string}</code></dt>
<dd><p>Method to use for reconstructing the tree:
</p><dl compact="compact">
<dt><code>upgma</code></dt>
<dd><p>Unweighted pair group method using arithmetic means
</p></dd>
<dt><code>wpgma</code></dt>
<dd><p>Weighted pair group method using aritmetic means
</p></dd>
<dt><code>nj</code></dt>
<dd><p>Neighbor-Joining (Saitou and Nei, 1987)
</p></dd>
<dt><code>bionj</code></dt>
<dd><p>BioNJ method (Gascuel, 1997)
</p></dd>
</dl>

</dd>
<dt><code>dist_mat={string}</code></dt>
<dd><p>The tag name of the distance matrix to use.
</p></dd>
</dl>

<a name="Extra_002ddata_003a-1"></a>
<h3 class="heading">Extra-data:</h3>

<dl compact="compact">
<dt><code>UPGMA|WPGMA|NJ|BioNJ</code></dt>
<dd><p>The resulting tree.
</p></dd>
</dl>


<hr>
<a name="NewOutgroup"></a>
<div class="header">
<p>
Next: <a href="#DropSpecies" accesskey="n" rel="next">DropSpecies</a>, Previous: <a href="#DistanceBasedPhylogeny" accesskey="p" rel="prev">DistanceBasedPhylogeny</a>, Up: <a href="#Phylogenetics" accesskey="u" rel="up">Phylogenetics</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Root-trees"></a>
<h4 class="subsubsection">2.3.2.3 Root trees</h4>

<p>The <code>NewOutgroup</code> filter takes an input tree and (re)root it according to a given species name.
</p>
<a name="Synopsis_003a-31"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    NewOutgroup(                            \
        tree_input=BioNJ,                   \
        tree_output=NioNJ_rooted,           \
        outgroup=outgroupSpecies),          \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-31"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>tree_input={string}</code></dt>
<dd><p>The tag name of the tree to reroot.
</p></dd>
<dt><code>tree_output={string}</code></dt>
<dd><p>The tag name to use to store the rerooted tree. If the same as <code>tree_input</code>, the rerooted tree will replace the old one.
</p></dd>
<dt><code>outgroup={string}</code></dt>
<dd><p>The name of the species to use as outgroup. One and only one sequence for this species should be present in each block for which rerooting is to be performed.
</p></dd>
</dl>

<a name="Extra_002ddata_003a-2"></a>
<h3 class="heading">Extra-data:</h3>

<dl compact="compact">
<dt><code>(user-defined tag)</code></dt>
<dd><p>A rooted tree.
</p></dd>
</dl>


<hr>
<a name="DropSpecies"></a>
<div class="header">
<p>
Next: <a href="#TreeFilter" accesskey="n" rel="next">TreeFilter</a>, Previous: <a href="#NewOutgroup" accesskey="p" rel="prev">NewOutgroup</a>, Up: <a href="#Phylogenetics" accesskey="u" rel="up">Phylogenetics</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Remove-a-species-from-a-tree"></a>
<h4 class="subsubsection">2.3.2.4 Remove a species from a tree</h4>

<p>The <code>DropSpecies</code> removes a leaf from a tree.
</p>
<a name="Synopsis_003a-32"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    DropSpecies(                            \
        tree_input=BioNJ,                   \
        tree_output=BioNJ_subtree,          \
        species=species1),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-32"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>tree_input={string}</code></dt>
<dd><p>The tag name of the tree to edit.
</p></dd>
<dt><code>tree_output={string}</code></dt>
<dd><p>The tag name to use to store the edited tree. If the same as <code>tree_input</code>, the edited tree will replace the old one.
</p></dd>
<dt><code>species={string}</code></dt>
<dd><p>The name of the species to remove. All leaves in the tree, if any, corresponding to a sequence for this species will be removed.
</p></dd>
</dl>

<a name="Extra_002ddata_003a-3"></a>
<h3 class="heading">Extra-data:</h3>

<dl compact="compact">
<dt><code>(user-defined tag)</code></dt>
<dd><p>An edited tree.
</p></dd>
</dl>


<hr>
<a name="TreeFilter"></a>
<div class="header">
<p>
Previous: <a href="#DropSpecies" accesskey="p" rel="prev">DropSpecies</a>, Up: <a href="#Phylogenetics" accesskey="u" rel="up">Phylogenetics</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Filter-blocks-based-on-their-associated-trees"></a>
<h4 class="subsubsection">2.3.2.5 Filter blocks based on their associated trees</h4>

<p>The <code>TreeFilter</code> (experimental) filters blocks based on their associated trees. Currently, filter is only performed based on the branch lengths.
</p>
<a name="Synopsis_003a-33"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    TreeFilter(                             \
        tree=BioNJ,                         \
        max_brlen=0.01,                     \
        file=data.trash_tree.maf.gz,        \
        compression=gzip),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-33"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>tree={string}</code></dt>
<dd><p>The tag name of the tree to analyse.
</p>
</dd>
<dt><code>max_brlen={float&gt;0}</code></dt>
<dd><p>Branch length threshold: any block with a tree containing at least one branch lenght longer than the given threshold will be filtered out.
</p>
</dd>
<dt><code>file={none|{path}}</code></dt>
<dd><p>An optional file were removed alignment parts will be stored, in the MAF format.
This can be helpful for visual inspection and fine tuning of the filter parameters.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file (if file != none).
</p>
</dd>
</dl>

<hr>
<a name="Exporting"></a>
<div class="header">
<p>
Next: <a href="#Miscelaneous" accesskey="n" rel="next">Miscelaneous</a>, Previous: <a href="#Analyzing" accesskey="p" rel="prev">Analyzing</a>, Up: <a href="#Filters" accesskey="u" rel="up">Filters</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Exporting-blocks-and-data"></a>
<h3 class="section">2.4 Exporting blocks and data</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Output" accesskey="1">Output</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OutputAlignments" accesskey="2">OutputAlignments</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OutputAsTable" accesskey="3">OutputAsTable</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#VcfOutput" accesskey="4">VcfOutput</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#MsmcOutput" accesskey="5">MsmcOutput</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#PlinkOutput" accesskey="6">PlinkOutput</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OutputCoordinates" accesskey="7">OutputCoordinates</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OutputTrees" accesskey="8">OutputTrees</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OutputDistanceMatrices" accesskey="9">OutputDistanceMatrices</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Output"></a>
<div class="header">
<p>
Next: <a href="#OutputAlignments" accesskey="n" rel="next">OutputAlignments</a>, Previous: <a href="#Exporting" accesskey="p" rel="prev">Exporting</a>, Up: <a href="#Exporting" accesskey="u" rel="up">Exporting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Write-alignment-blocks-to-a-MAF-file"></a>
<h4 class="subsection">2.4.1 Write alignment blocks to a MAF file</h4>

<p>The <code>Output</code> filter writes all blocks to a MAF file.
</p>
<a name="Synopsis_003a-34"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    Output(                                 \
        file=data.filtered.maf.gz,          \
        compression=gzip,                   \
        mask=yes),                          \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-34"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>file={none|{path}}</code></dt>
<dd><p>A file path where to write alignment blocks, in the MAF format.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
<dt><code>mask={yes|no}</code></dt>
<dd><p>Tell if sequences should be masked (if a mask annotation is available), or if masking information should be ignored.
</p>
</dd>
</dl>


<hr>
<a name="OutputAlignments"></a>
<div class="header">
<p>
Next: <a href="#OutputAsTable" accesskey="n" rel="next">OutputAsTable</a>, Previous: <a href="#Output" accesskey="p" rel="prev">Output</a>, Up: <a href="#Exporting" accesskey="u" rel="up">Exporting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Write-alignment-blocks-to-an-external-alignment-file_002e"></a>
<h4 class="subsection">2.4.2 Write alignment blocks to an external alignment file.</h4>

<p>The <code>OutputAlignments</code> filter writes all blocks to an external alignment file, potentially losing some information such as coordinates and scores.
Sequence names will be formated following the Ensembl convention when coordinates are available.
</p>
<a name="Synopsis_003a-35"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    OutputAlignments(                       \
        file=data.filtered.aln,             \
        compression=none,                   \
        format=Clustal,                     \
        mask=no,                            \
        coordinates=yes),                   \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-35"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>file={none|{path}}</code></dt>
<dd><p>A file path where to write alignment blocks. If the file name contains the %i code, one alignment file per block will be generated, where %i will be replaced by the block index.
In addition to the %i special code, additional variables can be used (in combination with %i, in order to avoid putative identical file names): chromosome number (%c), begin (%b) and end (%e) of reference sequence.
</p>
</dd>
<dt><code>format={string}</code></dt>
<dd><p>One of the alignment format supported by Bio++ (this includes Fasta, Mase and Clustal, see the Bio++ Program suite reference manual for a complete list of formats and options).
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
<dt><code>mask={yes|no}</code></dt>
<dd><p>Tell if sequences should be masked (if a mask annotation is available), or if masking information should be ignored.
</p>
</dd>
<dt><code>coordinates={yes|no}</code></dt>
<dd><p>Tell if coordinates of sequences should be written in the header of each sequence (followinf Ensembl syntax).
If set to no, or if sequences have no coordinates, only the species name will be used as a sequence name.
</p>
</dd>
<dt><code>ldhat_header={yes|no}</code></dt>
<dd><p>Tell if a header line should be added for each file, in order to be used with the LDhat convert program. This line contains the nimber of sequences, the sequence lengths, and the number 1 (for haploid).
</p>
</dd>
<dt><code>reference={string}</code></dt>
<dd><p>The name of reference sequence, which will only be used when %c, %b or %e codes are used in file names. In case a block does not contain a sequence for the reference species, &quot;ChrNA&quot;, &quot;StartNA&quot; and &quot;StopNA&quot; tags will be used.
</p>
</dd>
</dl>


<hr>
<a name="OutputAsTable"></a>
<div class="header">
<p>
Next: <a href="#VcfOutput" accesskey="n" rel="next">VcfOutput</a>, Previous: <a href="#OutputAlignments" accesskey="p" rel="prev">OutputAlignments</a>, Up: <a href="#Exporting" accesskey="u" rel="up">Exporting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Export-given-positions-into-a-table-format_002e"></a>
<h4 class="subsection">2.4.3 Export given positions into a table format.</h4>

<p>The <code>OutputAsTable</code> filter writes the nucleotide content of given positions in a table format.
</p>
<a name="Synopsis_003a-36"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    OutputTable(                            \
        file=data.txt,                      \
        species=Species1,Species2,Species3, \
        reference=RefSpecies,               \
        compression=none),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-36"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>file={none|{path}}</code></dt>
<dd><p>A file path where to write date in table format.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
<dt><code>species={list of {string}}</code></dt>
<dd><p>Select species for which data should be output (one column per species).
</p>
</dd>
<dt><code>reference={string}</code></dt>
<dd><p>Which species should be used for outputting coordinates.
</p>
</dd>
</dl>



<hr>
<a name="VcfOutput"></a>
<div class="header">
<p>
Next: <a href="#MsmcOutput" accesskey="n" rel="next">MsmcOutput</a>, Previous: <a href="#OutputAsTable" accesskey="p" rel="prev">OutputAsTable</a>, Up: <a href="#Exporting" accesskey="u" rel="up">Exporting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Call-SNPs-from-alignment-blocks-and-export-to-VCF-file"></a>
<h4 class="subsection">2.4.4 Call SNPs from alignment blocks and export to VCF file</h4>

<p>The <code>VcfOutput</code> filter call SNPs from each block and output them to a VCF file.
Only substitutions are called for now.
</p>
<a name="Synopsis_003a-37"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    VcfOutput(                              \
        file=snp.vcf.gz,                    \
        compression=gzip,                   \
        reference=Ref,                      \
        genotypes=(sample1,sample2),        \
        all=no),                            \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-37"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>file={none|{path}}</code></dt>
<dd><p>A file path for the output VCF file.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
<dt><code>reference={species name}</code></dt>
<dd><p>A species name corresponding to the sequence to use as reference.
</p>
</dd>
<dt><code>genotypes={list of species}</code></dt>
<dd><p>A list of species for which genotypes informations should be written. If not, void, a &rsquo;FORMAT&rsquo; column will be added to the output, as well as oneextra column per species to genotype.
If the species is not present in this particular, or if a N or Gap is present, a dot (&rsquo;.&rsquo;) will be written in the column.
Please note that species should be unique in each block, otherwise an error will occur.
</p>
</dd>
<dt><code>all={boolean}</code></dt>
<dd><p>If set to &rsquo;yes&rsquo;, also output non-variable positions in the VCF file.
</p>
</dd>
</dl>


<hr>
<a name="MsmcOutput"></a>
<div class="header">
<p>
Next: <a href="#PlinkOutput" accesskey="n" rel="next">PlinkOutput</a>, Previous: <a href="#VcfOutput" accesskey="p" rel="prev">VcfOutput</a>, Up: <a href="#Exporting" accesskey="u" rel="up">Exporting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Export-segregating-sites-to-MSMC-format"></a>
<h4 class="subsection">2.4.5 Export segregating sites to MSMC format</h4>

<p>The <code>MsmcOutput</code> filter calls all segregating sites and export them to the MSMC format,
to be used with the MSMC program <a href="https://github.com/stschiff/msmc">https://github.com/stschiff/msmc</a> (Multiple Sequentially Markovian Coalescent).
Sites with gap or unresolved characters are not called.
</p>
<a name="Synopsis_003a-38"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    MsmcOutput(                             \
        file=snp.msmc,                      \
        compression=none,                   \
        reference=Ref,                      \
        genotypes=(sample1,sample2)),       \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-38"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>file={none|{path}}</code></dt>
<dd><p>A file path for the output MSMC file.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
<dt><code>reference={species name}</code></dt>
<dd><p>A species name corresponding to the sequence to use as reference.
</p>
</dd>
<dt><code>genotypes={list of species}</code></dt>
<dd><p>A list of species for which segregating sites should be called. It might not contain the reference species, which is then only used for coordinates output.
Blocks with do not contain all species will not be called, as well as block not contianing the reference species. Note that the alignment has to be projected
againt the reference species, otherwise an error will be reported.
</p>
</dd>
</dl>


<hr>
<a name="PlinkOutput"></a>
<div class="header">
<p>
Next: <a href="#OutputCoordinates" accesskey="n" rel="next">OutputCoordinates</a>, Previous: <a href="#MsmcOutput" accesskey="p" rel="prev">MsmcOutput</a>, Up: <a href="#Exporting" accesskey="u" rel="up">Exporting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Export-segregating-sites-to-PLINK-format"></a>
<h4 class="subsection">2.4.6 Export segregating sites to PLINK format</h4>

<p>The <code>PlinkOutput</code> filter calls all biallelic segregating sites and export them to the PLINK format,
creating on Ped file and one Map file.
Sites with gap or unresolved characters are not called.
</p>
<a name="Synopsis_003a-39"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    PlinkOutput(                            \
        ped_file=snp.ped,                   \
        map_file=snp.map,                   \
        compression=none,                   \
        reference=Ref,                      \
        genotypes=(sample1,sample2),        \
        map3=no)                            \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-39"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>ped_file={none|{path}}</code></dt>
<dd><p>A file path for the output Ped file.
</p>
</dd>
<dt><code>map_file={none|{path}}</code></dt>
<dd><p>A file path for the output Map file.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
<dt><code>reference={species name}</code></dt>
<dd><p>A species name corresponding to the sequence to use as reference.
</p>
</dd>
<dt><code>genotypes={list of species}</code></dt>
<dd><p>A list of species for which segregating sites should be called. It might not contain the reference species, which is then only used for coordinates output.
Blocks with do not contain all species will not be called, as well as block not contianing the reference species. Note that the alignment has to be projected
againt the reference species, otherwise an error will be reported.
</p>
</dd>
<dt><code>map3={boolean}</code></dt>
<dd><p>Tell if genetic distance column should be ommitted in the Map file. The resulting file should be sued together with the &ndash;map3 option in PLINK.
If set to no, then a 0 genetic distance is written.
</p>
</dd>
</dl>


<hr>
<a name="OutputCoordinates"></a>
<div class="header">
<p>
Next: <a href="#OutputTrees" accesskey="n" rel="next">OutputTrees</a>, Previous: <a href="#PlinkOutput" accesskey="p" rel="prev">PlinkOutput</a>, Up: <a href="#Exporting" accesskey="u" rel="up">Exporting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Output-coordinates-of-a-set-of-species-for-each-block_002e"></a>
<h4 class="subsection">2.4.7 Output coordinates of a set of species for each block.</h4>

<p>The <code>OutputCoordinates</code> takes as input a list of species and output the coordinates of each of the corresponding sequences in each block.
This filter only works if no more than one sequence per species are present, otherwise an error is casted. If some species are missing in some blocks, NA are produced in the output file.
</p>
<a name="Synopsis_003a-40"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    OutputCoordinates(                      \
        file=coordinates.txt.gz,            \
        compression=gzip,                   \
        species=(species1,species2),        \
        output_src_size=yes)                \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-40"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>file={none|{path}}</code></dt>
<dd><p>A file path for the output text file.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
<dt><code>species={list of species}</code></dt>
<dd><p>A list of species for which coodinates should be written.
</p>
</dd>
<dt><code>output_src_size={boolean}</code></dt>
<dd><p>Tell if the size of source sequences should be output.
</p>
</dd>
</dl>


<hr>
<a name="OutputTrees"></a>
<div class="header">
<p>
Next: <a href="#OutputDistanceMatrices" accesskey="n" rel="next">OutputDistanceMatrices</a>, Previous: <a href="#OutputCoordinates" accesskey="p" rel="prev">OutputCoordinates</a>, Up: <a href="#Exporting" accesskey="u" rel="up">Exporting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Write-trees-to-a-file_002e"></a>
<h4 class="subsection">2.4.8 Write trees to a file.</h4>

<p>The <code>OutputTrees</code> filter writes trees associated to blocks to a file, in the Newick format. All trees will be stored in the same file, one per line.
</p>
<a name="Synopsis_003a-41"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    OutputTrees(                            \
        tree=BioNJ,                         \
        file=data.trees.dnd,                \
        compression=gzip),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-41"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>tree={string}</code></dt>
<dd><p>The tag used to store previously computed trees.
</p>
</dd>
<dt><code>file={none|{path}}</code></dt>
<dd><p>A file path where to write trees, in the Newick format.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
<dt><code>strip_names={boolean}</code></dt>
<dd><p>Tell if leaf names should be stripped. If so, all text after the first dot will be deleted.
This is useful to get rid of the sequence coordinates.
The option will have no effect in case the names do not contain coordinates.
</p>
</dd>
</dl>


<hr>
<a name="OutputDistanceMatrices"></a>
<div class="header">
<p>
Previous: <a href="#OutputTrees" accesskey="p" rel="prev">OutputTrees</a>, Up: <a href="#Exporting" accesskey="u" rel="up">Exporting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Write-distance-matrices-to-a-file_002e"></a>
<h4 class="subsection">2.4.9 Write distance matrices to a file.</h4>

<p>The <code>OutputDistanceMatrices</code> filter writes distance matrices associated to blocks to a file, in the Phylip format.
All matrices will be stored in the same file, one after the other.
</p>
<a name="Synopsis_003a-42"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    OutputDistanceMatrices(                 \
        distance=MLdistance,                \
        file=data.distmat.ph,               \
        compression=gzip),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-42"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>distance={string}</code></dt>
<dd><p>The tag used to store previously computed distance matrices.
</p>
</dd>
<dt><code>file={none|{path}}</code></dt>
<dd><p>A file path where to write distance matrices, in the Phylip format.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
<dt><code>strip_names={boolean}</code></dt>
<dd><p>Tell if sequence names should be stripped. If so, all text after the first dot will be deleted.
This is useful to get rid of the sequence coordinates.
The option will have no effect in case the names do not contain coordinates.
</p>
</dd>
</dl>


<hr>
<a name="Miscelaneous"></a>
<div class="header">
<p>
Previous: <a href="#Exporting" accesskey="p" rel="prev">Exporting</a>, Up: <a href="#Filters" accesskey="u" rel="up">Filters</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Miscelaneous-filters"></a>
<h3 class="section">2.5 Miscelaneous filters</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#LiftOver" accesskey="1">LiftOver</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SystemCall" accesskey="2">SystemCall</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<a name="LiftOver"></a>
<div class="header">
<p>
Next: <a href="#SystemCall" accesskey="n" rel="next">SystemCall</a>, Previous: <a href="#Miscelaneous" accesskey="p" rel="prev">Miscelaneous</a>, Up: <a href="#Miscelaneous" accesskey="u" rel="up">Miscelaneous</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Convert-coordinates-from-one-genome-to-another"></a>
<h4 class="subsection">2.5.1 Convert coordinates from one genome to another</h4>

<p>The <code>LiftOver</code> mimmics the behavior of the famous UCSC liftover utility.
Features are read from any supported format, and a convertion table is generated for all features included in the alignment.
</p>
<a name="Synopsis_003a-43"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...]
    LiftOver(                               \
        ref_species=species1,               \
        target_species=species2,            \
        target_closest_position=yes,        \
        feature.file=species1.gff3.gz,      \
        feature.file.compression=gzip,      \
        feature.format=GFF,                 \
        file=sp1_to_sp2.tln,                \
        compression=none),                  \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-43"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>ref_species={string}</code></dt>
<dd><p>The name of the species for which the coordinates of the features are provided.
</p>
</dd>
<dt><code>target_species={string}</code></dt>
<dd><p>The name of the species to which the coordinates of the features should be converted.
</p>
</dd>
<dt><code>target_closest_position={boolean}</code></dt>
<dd><p>In case the target sequence has a gap at the given position, outputs the coordinate of the previous non-gap position, otherwise NA.
</p>
</dd>
<dt><code>feature.file={path}</code></dt>
<dd><p>The file where the features are described.
</p>
</dd>
<dt><code>feature.file.compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for the feature file.
</p>
</dd>
<dt><code>feature.format={GFF|GTF|BedGraph}</code></dt>
<dd><p>Format for the feature file, currently GFF (v3.0), GTF or BedGraph.
</p>
</dd>
<dt><code>compression={none|gzip|zip|bzip2}</code></dt>
<dd><p>Compression format for output file.
</p>
</dd>
</dl>


<hr>
<a name="SystemCall"></a>
<div class="header">
<p>
Previous: <a href="#LiftOver" accesskey="p" rel="prev">LiftOver</a>, Up: <a href="#Miscelaneous" accesskey="u" rel="up">Miscelaneous</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Call-an-external-program-on-each-block_002e"></a>
<h4 class="subsection">2.5.2 Call an external program on each block.</h4>

<p>The <code>SystemCall</code> filter runs an external program on each block.
For each block, the alignment is written to a temporary file, whose name and format can be specified.
This input file is then read by the external program. The called program is expected to generate results in the form of an alignment with the same sequence names, so that it can be read by maffilter.
In most case, the external program will be a wrapper script.
</p><a name="Synopsis_003a-44"></a>
<h3 class="heading">Synopsis:</h3>

<table class="cartouche" border="1"><tr><td>
<div class="example">
<pre class="example">maf.filter=                                 \
    [...],
    SystemCall(                             \
        name=myextprog,                     \
        input.file=tmp.fa,                  \
        input.format=Fasta,                 \
        call=myscript.sh,                   \
        output.file=output.fa,              \
        output.format=Fasta),               \
    [...]
</pre></div>
</td></tr></table>

<a name="Arguments_003a-44"></a>
<h3 class="heading">Arguments:</h3>

<dl compact="compact">
<dt><code>name={string}</code></dt>
<dd><p>A label to use, might be useful in case several tools are called.
</p>
</dd>
<dt><code>input.file={none|{path}}</code></dt>
<dd><p>A file path where to write the block alignment, to be used as input by the external program.
</p>
</dd>
<dt><code>input.format={string}</code></dt>
<dd><p>Alignment format for input file.
</p>
</dd>
<dt><code>output.file={none|{path}}</code></dt>
<dd><p>A file path where to read the processed block alignment, output by the external program.
</p>
</dd>
<dt><code>output.format={string}</code></dt>
<dd><p>Alignment format for output file.
</p>
</dd>
<dt><code>call={string}</code></dt>
<dd><p>The system call to run external program.
</p>
</dd>
</dl>






<hr>



</body>
</html>
